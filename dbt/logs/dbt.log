[0m15:38:47.230138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e08fef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e0398d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e039bb10>]}


============================== 15:38:47.231479 | 042b43e7-a9b1-4584-9883-75104f4cdcef ==============================
[0m15:38:47.231479 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:38:47.231798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'debug': 'False', 'profiles_dir': '/home/barry/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:38:47.236120 [info ] [MainThread]: dbt version: 1.8.2
[0m15:38:47.236340 [info ] [MainThread]: python version: 3.11.9
[0m15:38:47.236684 [info ] [MainThread]: python path: /home/barry/de_project/data-engineering-zoomcamp/.venv/bin/python3
[0m15:38:47.236861 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:38:47.237097 [info ] [MainThread]: Using profiles dir at /home/barry/.dbt
[0m15:38:47.237281 [info ] [MainThread]: Using profiles.yml file at /home/barry/.dbt/profiles.yml
[0m15:38:47.237427 [info ] [MainThread]: Using dbt_project.yml file at /home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/dbt_project.yml
[0m15:38:47.280903 [info ] [MainThread]: Configuration:
[0m15:38:47.281187 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m15:38:47.281356 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:38:47.281509 [info ] [MainThread]: Required dependencies:
[0m15:38:47.281681 [debug] [MainThread]: Executing "git --help"
[0m15:38:47.282609 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:38:47.282896 [debug] [MainThread]: STDERR: "b''"
[0m15:38:47.283030 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:38:47.283235 [info ] [MainThread]: Connection test skipped since no profile was found
[0m15:38:47.283408 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:38:47.283554 [info ] [MainThread]: dbt looked for a profiles.yml file in /home/barry/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m15:38:47.283931 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.07494524, "process_user_time": 0.540887, "process_kernel_time": 0.051027, "process_mem_max_rss": "91908", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m15:38:47.284167 [debug] [MainThread]: Command `dbt debug` failed at 15:38:47.284125 after 0.08 seconds
[0m15:38:47.284455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e03a65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e3f87c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53e40c22d0>]}
[0m15:38:47.284649 [debug] [MainThread]: Flushing usage events
[0m15:43:06.868184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2163c510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2163e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2163e790>]}


============================== 15:43:06.870081 | 708b1628-f711-4b35-9bb0-1842239ad2ed ==============================
[0m15:43:06.870081 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:43:06.870392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt init', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:43:06.877551 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/home/barry/.dbt')}
[0m15:43:06.877866 [info ] [MainThread]: Creating dbt configuration folder at 
[0m15:43:06.879936 [info ] [MainThread]: Setting up your profile.
[0m15:45:55.269801 [error] [MainThread]: Encountered an error:

[0m15:45:55.277277 [error] [MainThread]: Traceback (most recent call last):
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 321, in run
    self.setup_profile(profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 263, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 180, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 164, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 117, in generate_target_from_input
    target = self.generate_target_from_input(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 130, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m15:45:55.278596 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 168.44046, "process_user_time": 1.267706, "process_kernel_time": 1.436074, "process_mem_max_rss": "223580", "process_in_blocks": "252968", "process_out_blocks": "24", "command_success": false}
[0m15:45:55.279252 [debug] [MainThread]: Command `dbt init` failed at 15:45:55.279167 after 168.44 seconds
[0m15:45:55.279560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2149e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a25093dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3a2146b210>]}
[0m15:45:55.279854 [debug] [MainThread]: Flushing usage events
[0m15:46:24.807769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf14a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf14a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf14a2d0>]}


============================== 15:46:24.809240 | 2d08832a-d6c5-4d6c-9bf3-e338e13f33e6 ==============================
[0m15:46:24.809240 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:46:24.809585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:24.814295 [info ] [MainThread]: Setting up your profile.
[0m15:46:58.143903 [error] [MainThread]: Encountered an error:

[0m15:46:58.146402 [error] [MainThread]: Traceback (most recent call last):
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 321, in run
    self.setup_profile(profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 263, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 180, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 164, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 117, in generate_target_from_input
    target = self.generate_target_from_input(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 130, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m15:46:58.147470 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 33.364124, "process_user_time": 1.267118, "process_kernel_time": 1.378624, "process_mem_max_rss": "225248", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m15:46:58.147956 [debug] [MainThread]: Command `dbt init` failed at 15:46:58.147858 after 33.36 seconds
[0m15:46:58.148265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ad2ddfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4acf1a6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a8a34db10>]}
[0m15:46:58.148549 [debug] [MainThread]: Flushing usage events
[0m15:47:01.767171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f735d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f7706b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f735df90>]}


============================== 15:47:01.768453 | 18988fb3-45e8-48ac-835c-cf61f03c7a44 ==============================
[0m15:47:01.768453 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:47:01.768810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:01.773470 [info ] [MainThread]: Setting up your profile.
[0m15:48:37.464551 [info ] [MainThread]: Profile default written to /home/barry/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m15:48:37.465419 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 95.72278, "process_user_time": 1.193597, "process_kernel_time": 1.448605, "process_mem_max_rss": "227316", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m15:48:37.465863 [debug] [MainThread]: Command `dbt init` succeeded at 15:48:37.465780 after 95.72 seconds
[0m15:48:37.466166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f735dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f735ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9b3d8af10>]}
[0m15:48:37.466465 [debug] [MainThread]: Flushing usage events
[0m15:48:47.590448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2eb8b0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2eb8b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2eb8b710>]}


============================== 15:48:47.591700 | fc126ded-a7c9-48e0-9f8a-762442860b37 ==============================
[0m15:48:47.591700 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:48:47.591971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:48:47.600338 [info ] [MainThread]: dbt version: 1.8.2
[0m15:48:47.600565 [info ] [MainThread]: python version: 3.11.9
[0m15:48:47.600736 [info ] [MainThread]: python path: /home/barry/de_project/data-engineering-zoomcamp/.venv/bin/python3
[0m15:48:47.600904 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:48:47.904254 [info ] [MainThread]: Using profiles dir at /home/barry/.dbt
[0m15:48:47.904530 [info ] [MainThread]: Using profiles.yml file at /home/barry/.dbt/profiles.yml
[0m15:48:47.904711 [info ] [MainThread]: Using dbt_project.yml file at /home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/dbt_project.yml
[0m15:48:47.905038 [info ] [MainThread]: adapter type: bigquery
[0m15:48:47.905565 [info ] [MainThread]: adapter version: 1.8.1
[0m15:48:47.949609 [info ] [MainThread]: Configuration:
[0m15:48:47.949898 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:48:47.950069 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:48:47.950267 [info ] [MainThread]: Required dependencies:
[0m15:48:47.950479 [debug] [MainThread]: Executing "git --help"
[0m15:48:47.955804 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:48:47.956023 [debug] [MainThread]: STDERR: "b''"
[0m15:48:47.956164 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:48:47.956314 [info ] [MainThread]: Connection:
[0m15:48:47.956478 [info ] [MainThread]:   method: service-account
[0m15:48:47.956620 [info ] [MainThread]:   database: dbt-project-426013
[0m15:48:47.956869 [info ] [MainThread]:   execution_project: dbt-project-426013
[0m15:48:47.957009 [info ] [MainThread]:   schema: dbt_dataset
[0m15:48:47.957142 [info ] [MainThread]:   location: US
[0m15:48:47.957277 [info ] [MainThread]:   priority: interactive
[0m15:48:47.957426 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:48:47.957559 [info ] [MainThread]:   impersonate_service_account: None
[0m15:48:47.957688 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:48:47.957818 [info ] [MainThread]:   job_retries: 1
[0m15:48:47.957951 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:48:47.958087 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:48:47.958220 [info ] [MainThread]:   timeout_seconds: 300
[0m15:48:47.958351 [info ] [MainThread]:   client_id: None
[0m15:48:47.958501 [info ] [MainThread]:   token_uri: None
[0m15:48:47.958629 [info ] [MainThread]:   dataproc_region: None
[0m15:48:47.958755 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:48:47.958881 [info ] [MainThread]:   gcs_bucket: None
[0m15:48:47.959012 [info ] [MainThread]:   dataproc_batch: None
[0m15:48:47.959321 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m15:48:47.960946 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:48:47.961128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:47.961318 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '~/de_project/data-engineering-zoomcamp/credential.json''
[0m15:48:47.961485 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:48:47.961645 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:48:47.961785 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '~/de_project/data-engineering-zoomcamp/credential.json'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:48:47.962146 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.39231414, "process_user_time": 1.279181, "process_kernel_time": 1.430266, "process_mem_max_rss": "236260", "process_in_blocks": "416", "process_out_blocks": "32", "command_success": false}
[0m15:48:47.962405 [debug] [MainThread]: Command `dbt debug` failed at 15:48:47.962359 after 0.39 seconds
[0m15:48:47.962561 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:48:47.962731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e2ebd2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e3279bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0de89d5710>]}
[0m15:48:47.962908 [debug] [MainThread]: Flushing usage events
[0m15:50:18.508882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a26692890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a26692810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a26693950>]}


============================== 15:50:18.510201 | da06027f-85e6-458d-9130-b5dfb6011d2f ==============================
[0m15:50:18.510201 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:50:18.510484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'debug': 'False', 'profiles_dir': '/home/barry/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:50:18.514179 [info ] [MainThread]: dbt version: 1.8.2
[0m15:50:18.514408 [info ] [MainThread]: python version: 3.11.9
[0m15:50:18.514602 [info ] [MainThread]: python path: /home/barry/de_project/data-engineering-zoomcamp/.venv/bin/python3
[0m15:50:18.514819 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:50:18.824984 [info ] [MainThread]: Using profiles dir at /home/barry/.dbt
[0m15:50:18.825302 [info ] [MainThread]: Using profiles.yml file at /home/barry/.dbt/profiles.yml
[0m15:50:18.825468 [info ] [MainThread]: Using dbt_project.yml file at /home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/dbt_project.yml
[0m15:50:18.825693 [info ] [MainThread]: adapter type: bigquery
[0m15:50:18.825886 [info ] [MainThread]: adapter version: 1.8.1
[0m15:50:18.867952 [info ] [MainThread]: Configuration:
[0m15:50:18.868221 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:50:18.868384 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:50:18.868538 [info ] [MainThread]: Required dependencies:
[0m15:50:18.868704 [debug] [MainThread]: Executing "git --help"
[0m15:50:18.869795 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:50:18.870024 [debug] [MainThread]: STDERR: "b''"
[0m15:50:18.870162 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:50:18.870319 [info ] [MainThread]: Connection:
[0m15:50:18.870480 [info ] [MainThread]:   method: service-account
[0m15:50:18.870630 [info ] [MainThread]:   database: dbt-project-426013
[0m15:50:18.870768 [info ] [MainThread]:   execution_project: dbt-project-426013
[0m15:50:18.870902 [info ] [MainThread]:   schema: dbt_dataset
[0m15:50:18.871035 [info ] [MainThread]:   location: US
[0m15:50:18.871158 [info ] [MainThread]:   priority: interactive
[0m15:50:18.871289 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:50:18.871421 [info ] [MainThread]:   impersonate_service_account: None
[0m15:50:18.871553 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:50:18.871689 [info ] [MainThread]:   job_retries: 1
[0m15:50:18.871819 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:50:18.871947 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:50:18.872077 [info ] [MainThread]:   timeout_seconds: 300
[0m15:50:18.872207 [info ] [MainThread]:   client_id: None
[0m15:50:18.872335 [info ] [MainThread]:   token_uri: None
[0m15:50:18.872464 [info ] [MainThread]:   dataproc_region: None
[0m15:50:18.872589 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:50:18.872721 [info ] [MainThread]:   gcs_bucket: None
[0m15:50:18.872847 [info ] [MainThread]:   dataproc_batch: None
[0m15:50:18.873048 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m15:50:18.873706 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:50:18.873875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:18.874055 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '$HOME/de_project/data-engineering-zoomcamp/credential.json''
[0m15:50:18.874220 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:50:18.874465 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:50:18.874647 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '$HOME/de_project/data-engineering-zoomcamp/credential.json'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:50:18.875162 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.38695318, "process_user_time": 1.34942, "process_kernel_time": 1.369712, "process_mem_max_rss": "231944", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m15:50:18.875431 [debug] [MainThread]: Command `dbt debug` failed at 15:50:18.875383 after 0.39 seconds
[0m15:50:18.875617 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:50:18.875807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a266d3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a2a317b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a266dc290>]}
[0m15:50:18.875994 [debug] [MainThread]: Flushing usage events
[0m15:50:33.673784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4835bfdc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4835bff0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4835bfeb90>]}


============================== 15:50:33.675127 | 29a63f88-435d-46f2-bcba-77e6fd366cde ==============================
[0m15:50:33.675127 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:50:33.675418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:50:33.679112 [info ] [MainThread]: dbt version: 1.8.2
[0m15:50:33.679354 [info ] [MainThread]: python version: 3.11.9
[0m15:50:33.679563 [info ] [MainThread]: python path: /home/barry/de_project/data-engineering-zoomcamp/.venv/bin/python3
[0m15:50:33.679746 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:50:33.990259 [info ] [MainThread]: Using profiles dir at /home/barry/.dbt
[0m15:50:33.990692 [info ] [MainThread]: Using profiles.yml file at /home/barry/.dbt/profiles.yml
[0m15:50:33.990960 [info ] [MainThread]: Using dbt_project.yml file at /home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/dbt_project.yml
[0m15:50:33.991166 [info ] [MainThread]: adapter type: bigquery
[0m15:50:33.991433 [info ] [MainThread]: adapter version: 1.8.1
[0m15:50:34.034326 [info ] [MainThread]: Configuration:
[0m15:50:34.034587 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:50:34.034758 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:50:34.034926 [info ] [MainThread]: Required dependencies:
[0m15:50:34.035110 [debug] [MainThread]: Executing "git --help"
[0m15:50:34.036151 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:50:34.036359 [debug] [MainThread]: STDERR: "b''"
[0m15:50:34.036494 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:50:34.036651 [info ] [MainThread]: Connection:
[0m15:50:34.036805 [info ] [MainThread]:   method: service-account
[0m15:50:34.036954 [info ] [MainThread]:   database: dbt-project-426013
[0m15:50:34.037102 [info ] [MainThread]:   execution_project: dbt-project-426013
[0m15:50:34.037246 [info ] [MainThread]:   schema: dbt_dataset
[0m15:50:34.037377 [info ] [MainThread]:   location: US
[0m15:50:34.037516 [info ] [MainThread]:   priority: interactive
[0m15:50:34.037666 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:50:34.037809 [info ] [MainThread]:   impersonate_service_account: None
[0m15:50:34.037949 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:50:34.038080 [info ] [MainThread]:   job_retries: 1
[0m15:50:34.038211 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:50:34.038340 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:50:34.038469 [info ] [MainThread]:   timeout_seconds: 300
[0m15:50:34.038616 [info ] [MainThread]:   client_id: None
[0m15:50:34.038745 [info ] [MainThread]:   token_uri: None
[0m15:50:34.038871 [info ] [MainThread]:   dataproc_region: None
[0m15:50:34.038999 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:50:34.039174 [info ] [MainThread]:   gcs_bucket: None
[0m15:50:34.039395 [info ] [MainThread]:   dataproc_batch: None
[0m15:50:34.039645 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m15:50:34.040318 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:50:34.040488 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:34.040664 [debug] [MainThread]: BigQuery adapter: Got an error when attempting to create a bigquery client: '[Errno 2] No such file or directory: '$HOME/de_project/data-engineering-zoomcamp/credential.json''
[0m15:50:34.040818 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:50:34.040982 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:50:34.041235 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  [Errno 2] No such file or directory: '$HOME/de_project/data-engineering-zoomcamp/credential.json'

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:50:34.041698 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.38863117, "process_user_time": 1.242423, "process_kernel_time": 1.462853, "process_mem_max_rss": "229996", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m15:50:34.041953 [debug] [MainThread]: Command `dbt debug` failed at 15:50:34.041909 after 0.39 seconds
[0m15:50:34.042112 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:50:34.042260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4839653dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4835a4d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4835adda50>]}
[0m15:50:34.042430 [debug] [MainThread]: Flushing usage events
[0m15:51:04.658724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a01b5dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a0922290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a01bffd0>]}


============================== 15:51:04.660842 | d6f103af-da6f-45ea-89e6-53f038b5ba54 ==============================
[0m15:51:04.660842 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:51:04.661155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:04.668382 [info ] [MainThread]: dbt version: 1.8.2
[0m15:51:04.668623 [info ] [MainThread]: python version: 3.11.9
[0m15:51:04.668818 [info ] [MainThread]: python path: /home/barry/de_project/data-engineering-zoomcamp/.venv/bin/python3
[0m15:51:04.668987 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m15:51:05.245185 [info ] [MainThread]: Using profiles dir at /home/barry/.dbt
[0m15:51:05.245467 [info ] [MainThread]: Using profiles.yml file at /home/barry/.dbt/profiles.yml
[0m15:51:05.245781 [info ] [MainThread]: Using dbt_project.yml file at /home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/dbt_project.yml
[0m15:51:05.246012 [info ] [MainThread]: adapter type: bigquery
[0m15:51:05.246195 [info ] [MainThread]: adapter version: 1.8.1
[0m15:51:05.288639 [info ] [MainThread]: Configuration:
[0m15:51:05.288951 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:51:05.289247 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:51:05.289450 [info ] [MainThread]: Required dependencies:
[0m15:51:05.289651 [debug] [MainThread]: Executing "git --help"
[0m15:51:05.300030 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:51:05.300304 [debug] [MainThread]: STDERR: "b''"
[0m15:51:05.300452 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:51:05.300613 [info ] [MainThread]: Connection:
[0m15:51:05.300820 [info ] [MainThread]:   method: service-account
[0m15:51:05.300978 [info ] [MainThread]:   database: dbt-project-426013
[0m15:51:05.301119 [info ] [MainThread]:   execution_project: dbt-project-426013
[0m15:51:05.301252 [info ] [MainThread]:   schema: dbt_dataset
[0m15:51:05.301384 [info ] [MainThread]:   location: US
[0m15:51:05.301516 [info ] [MainThread]:   priority: interactive
[0m15:51:05.301645 [info ] [MainThread]:   maximum_bytes_billed: None
[0m15:51:05.301780 [info ] [MainThread]:   impersonate_service_account: None
[0m15:51:05.301908 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m15:51:05.302038 [info ] [MainThread]:   job_retries: 1
[0m15:51:05.302169 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m15:51:05.302298 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m15:51:05.302429 [info ] [MainThread]:   timeout_seconds: 300
[0m15:51:05.302560 [info ] [MainThread]:   client_id: None
[0m15:51:05.302688 [info ] [MainThread]:   token_uri: None
[0m15:51:05.302824 [info ] [MainThread]:   dataproc_region: None
[0m15:51:05.302956 [info ] [MainThread]:   dataproc_cluster_name: None
[0m15:51:05.303084 [info ] [MainThread]:   gcs_bucket: None
[0m15:51:05.303209 [info ] [MainThread]:   dataproc_batch: None
[0m15:51:05.303419 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m15:51:05.304793 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m15:51:05.305010 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:05.305927 [debug] [MainThread]: On debug: select 1 as id
[0m15:51:05.789974 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:fb208972-6f34-4455-bf23-c6afea9e6df6&page=queryresults
[0m15:51:06.459949 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:51:06.461241 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:51:06.464110 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.8267848, "process_user_time": 1.2389, "process_kernel_time": 1.542791, "process_mem_max_rss": "232084", "process_in_blocks": "258280", "process_out_blocks": "32"}
[0m15:51:06.464926 [debug] [MainThread]: Command `dbt debug` succeeded at 15:51:06.464786 after 1.83 seconds
[0m15:51:06.465391 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:51:06.465814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a3de7c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18a3de7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1856dc0f10>]}
[0m15:51:06.466300 [debug] [MainThread]: Flushing usage events
[0m15:51:40.892992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806af3ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806af3be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806af3aa50>]}


============================== 15:51:40.894365 | d9e37366-ea4e-4704-b46a-afae10bdb907 ==============================
[0m15:51:40.894365 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:51:40.894655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'fail_fast': 'False', 'profiles_dir': '/home/barry/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:40.903795 [info ] [MainThread]: Setting up your profile.
[0m15:52:09.430968 [error] [MainThread]: Encountered an error:

[0m15:52:09.439462 [error] [MainThread]: Traceback (most recent call last):
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/cli/main.py", line 470, in init
    results = task.run()
              ^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 321, in run
    self.setup_profile(profile_name)
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 249, in setup_profile
    if not self.check_if_can_write_profile(profile_name=profile_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/dbt/task/init.py", line 212, in check_if_can_write_profile
    response = click.confirm(
               ^^^^^^^^^^^^^^
  File "/home/barry/de_project/data-engineering-zoomcamp/.venv/lib64/python3.11/site-packages/click/termui.py", line 235, in confirm
    raise Abort() from None
click.exceptions.Abort

[0m15:52:09.440268 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 28.569672, "process_user_time": 0.475211, "process_kernel_time": 0.069301, "process_mem_max_rss": "89736", "process_in_blocks": "200", "process_out_blocks": "24", "command_success": false}
[0m15:52:09.440686 [debug] [MainThread]: Command `dbt init` failed at 15:52:09.440604 after 28.57 seconds
[0m15:52:09.440958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806e997dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806ad92350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f806ead6410>]}
[0m15:52:09.441217 [debug] [MainThread]: Flushing usage events
[0m15:52:27.219778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462fd03510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46300b2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46300b30d0>]}


============================== 15:52:27.221091 | 07c90331-fdaf-4f61-b95f-b03ac97850d5 ==============================
[0m15:52:27.221091 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:52:27.221386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'version_check': 'True', 'profiles_dir': '/home/barry/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:52:27.595800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07c90331-fdaf-4f61-b95f-b03ac97850d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462bbee710>]}
[0m15:52:27.621130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07c90331-fdaf-4f61-b95f-b03ac97850d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4631a4a350>]}
[0m15:52:27.621480 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m15:52:27.622475 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m15:52:27.623255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4250252, "process_user_time": 1.354735, "process_kernel_time": 1.385065, "process_mem_max_rss": "233672", "process_in_blocks": "280", "process_out_blocks": "8", "command_success": false}
[0m15:52:27.623552 [debug] [MainThread]: Command `dbt run` failed at 15:52:27.623501 after 0.43 seconds
[0m15:52:27.623754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f463375fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462fb57650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f462fb55990>]}
[0m15:52:27.623932 [debug] [MainThread]: Flushing usage events
[0m15:53:10.199611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb362d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb3b2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb362f10>]}


============================== 15:53:10.200921 | 345fba40-199b-48f3-ae7b-aaef9bc82a2e ==============================
[0m15:53:10.200921 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:53:10.201200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'profiles_dir': '/home/barry/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:10.248739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '345fba40-199b-48f3-ae7b-aaef9bc82a2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb3f8a50>]}
[0m15:53:10.258136 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hta_y6c_'
[0m15:53:10.258367 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:53:10.465192 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:53:10.466573 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:53:10.652327 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:53:10.659720 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m15:53:11.086785 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m15:53:11.087819 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:53:11.604313 [info ] [MainThread]: Installed from version 1.1.1
[0m15:53:11.604572 [info ] [MainThread]: Updated version available: 1.2.0
[0m15:53:11.604768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '345fba40-199b-48f3-ae7b-aaef9bc82a2e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bca4a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bc9ed410>]}
[0m15:53:11.604941 [info ] [MainThread]: Installing dbt-labs/codegen
[0m15:53:11.904738 [info ] [MainThread]: Installed from version 0.12.1
[0m15:53:11.905007 [info ] [MainThread]: Up to date!
[0m15:53:11.905222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '345fba40-199b-48f3-ae7b-aaef9bc82a2e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bb31d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bc9f16d0>]}
[0m15:53:11.905415 [info ] [MainThread]: 
[0m15:53:11.905583 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m15:53:11.906096 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.7267597, "process_user_time": 0.605203, "process_kernel_time": 0.049606, "process_mem_max_rss": "92848", "process_in_blocks": "1424", "process_out_blocks": "2928"}
[0m15:53:11.906368 [debug] [MainThread]: Command `dbt deps` succeeded at 15:53:11.906324 after 1.73 seconds
[0m15:53:11.906523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1befefb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1befefa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1bf12a310>]}
[0m15:53:11.906679 [debug] [MainThread]: Flushing usage events
[0m15:53:22.951857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b493fad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b493f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b493e950>]}


============================== 15:53:22.953228 | 3c18e6c4-9a09-4448-b800-eb21abed38ea ==============================
[0m15:53:22.953228 [info ] [MainThread]: Running with dbt=1.8.2
[0m15:53:22.953502 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:53:23.321170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56a90cb90>]}
[0m15:53:23.346512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b66862d0>]}
[0m15:53:23.346821 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m15:53:23.360394 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m15:53:23.360750 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:53:23.360955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56a696710>]}
[0m15:53:24.123060 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m15:53:24.123342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56a5b0290>]}
[0m15:53:24.291645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542f60490>]}
[0m15:53:24.354375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542ce9050>]}
[0m15:53:24.354673 [info ] [MainThread]: Found 5 models, 1 analysis, 1 seed, 11 data tests, 2 sources, 606 macros
[0m15:53:24.354867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56a3e67d0>]}
[0m15:53:24.355821 [info ] [MainThread]: 
[0m15:53:24.356161 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:24.358191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-project-426013'
[0m15:53:24.358449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:24.726205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-project-426013, now list_dbt-project-426013_dbt_dataset)
[0m15:53:24.727330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:25.126976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa56a2c7210>]}
[0m15:53:25.128434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:25.129257 [info ] [MainThread]: 
[0m15:53:25.136705 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m15:53:25.137072 [info ] [Thread-1 (]: 1 of 5 START sql table model dbt_dataset.dim_zones ............................. [RUN]
[0m15:53:25.137386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-project-426013_dbt_dataset, now model.taxi_rides_ny.dim_zones)
[0m15:53:25.137593 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m15:53:25.141177 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m15:53:25.141724 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m15:53:25.158386 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m15:53:25.158897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:25.159609 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
    );
  
[0m15:53:25.742602 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:f79f2024-0d74-4f46-af3d-6eb7ecaa2eee&page=queryresults
[0m15:53:25.743422 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
/* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
    );
  
[0m15:53:25.743864 [debug] [Thread-1 (]: BigQuery adapter: 404 Not found: Table dbt-project-426013:dbt_dataset.taxi_zone_lookup was not found in location US; reason: notFound, message: Not found: Table dbt-project-426013:dbt_dataset.taxi_zone_lookup was not found in location US

Location: US
Job ID: f79f2024-0d74-4f46-af3d-6eb7ecaa2eee

[0m15:53:25.754181 [debug] [Thread-1 (]: Runtime Error in model dim_zones (models/core/dim_zones.sql)
  404 Not found: Table dbt-project-426013:dbt_dataset.taxi_zone_lookup was not found in location US; reason: notFound, message: Not found: Table dbt-project-426013:dbt_dataset.taxi_zone_lookup was not found in location US
  
  Location: US
  Job ID: f79f2024-0d74-4f46-af3d-6eb7ecaa2eee
  
[0m15:53:25.755099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542ce1550>]}
[0m15:53:25.755594 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model dbt_dataset.dim_zones .................... [[31mERROR[0m in 0.62s]
[0m15:53:25.756011 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m15:53:25.756302 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m15:53:25.757045 [info ] [Thread-1 (]: 2 of 5 START sql view model dbt_dataset.stg_green_tripdata ..................... [RUN]
[0m15:53:25.757307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now model.taxi_rides_ny.stg_green_tripdata)
[0m15:53:25.757477 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m15:53:25.811405 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m15:53:25.811899 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m15:53:25.821002 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m15:53:25.821514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:25.822438 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m15:53:26.538568 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:e216962c-f5ab-4c3c-b7ff-170e1992d21a&page=queryresults
[0m15:53:27.089296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542f2f9d0>]}
[0m15:53:27.089709 [info ] [Thread-1 (]: 2 of 5 OK created sql view model dbt_dataset.stg_green_tripdata ................ [[32mCREATE VIEW (0 processed)[0m in 1.33s]
[0m15:53:27.090491 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m15:53:27.090735 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m15:53:27.091093 [info ] [Thread-1 (]: 3 of 5 START sql view model dbt_dataset.stg_yellow_tripdata .................... [RUN]
[0m15:53:27.091363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m15:53:27.091536 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m15:53:27.095379 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m15:53:27.095859 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m15:53:27.097144 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m15:53:27.097414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:27.098154 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m15:53:27.662657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:bcddf8bc-6b1e-42eb-b393-a863cc169a70&page=queryresults
[0m15:53:28.198587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18e6c4-9a09-4448-b800-eb21abed38ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa542d410d0>]}
[0m15:53:28.200231 [info ] [Thread-1 (]: 3 of 5 OK created sql view model dbt_dataset.stg_yellow_tripdata ............... [[32mCREATE VIEW (0 processed)[0m in 1.11s]
[0m15:53:28.200580 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m15:53:28.201309 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m15:53:28.201543 [info ] [Thread-1 (]: 4 of 5 SKIP relation dbt_dataset.fact_trips .................................... [[33mSKIP[0m]
[0m15:53:28.201756 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m15:53:28.202176 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m15:53:28.202374 [info ] [Thread-1 (]: 5 of 5 SKIP relation dbt_dataset.dm_monthly_zone_revenue ....................... [[33mSKIP[0m]
[0m15:53:28.202578 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m15:53:28.203617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:28.203854 [debug] [MainThread]: Connection 'model.taxi_rides_ny.stg_yellow_tripdata' was properly closed.
[0m15:53:28.204124 [info ] [MainThread]: 
[0m15:53:28.204362 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 3.85 seconds (3.85s).
[0m15:53:28.204884 [debug] [MainThread]: Command end result
[0m15:53:28.222527 [info ] [MainThread]: 
[0m15:53:28.222768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:53:28.223049 [info ] [MainThread]: 
[0m15:53:28.223296 [error] [MainThread]:   Runtime Error in model dim_zones (models/core/dim_zones.sql)
  404 Not found: Table dbt-project-426013:dbt_dataset.taxi_zone_lookup was not found in location US; reason: notFound, message: Not found: Table dbt-project-426013:dbt_dataset.taxi_zone_lookup was not found in location US
  
  Location: US
  Job ID: f79f2024-0d74-4f46-af3d-6eb7ecaa2eee
  
[0m15:53:28.223459 [info ] [MainThread]: 
[0m15:53:28.223617 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 TOTAL=5
[0m15:53:28.224049 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.293315, "process_user_time": 2.574892, "process_kernel_time": 1.441541, "process_mem_max_rss": "252108", "process_in_blocks": "4384", "process_out_blocks": "4328", "command_success": false}
[0m15:53:28.224438 [debug] [MainThread]: Command `dbt run` failed at 15:53:28.224349 after 5.29 seconds
[0m15:53:28.224656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b839bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b84da410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5b84d99d0>]}
[0m15:53:28.224830 [debug] [MainThread]: Flushing usage events
[0m16:42:27.549824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c65f2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c6642f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c6ba2a10>]}


============================== 16:42:27.552258 | 5e5d91bd-ad7c-4bc5-907b-dc84695c97bb ==============================
[0m16:42:27.552258 [info ] [MainThread]: Running with dbt=1.8.2
[0m16:42:27.552562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/barry/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/barry/de_project/data-engineering-zoomcamp/04-analytics-engineering/taxi_rides_ny/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:42:28.166730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1805217d0>]}
[0m16:42:28.191892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1c851ab90>]}
[0m16:42:28.192229 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m16:42:28.203181 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m16:42:28.335360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:28.335608 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:28.365786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc180871c90>]}
[0m16:42:28.435557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17bed7fd0>]}
[0m16:42:28.435864 [info ] [MainThread]: Found 5 models, 1 analysis, 1 seed, 11 data tests, 2 sources, 606 macros
[0m16:42:28.437340 [info ] [MainThread]: 
[0m16:42:28.437797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:42:28.440461 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-project-426013'
[0m16:42:28.440727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:28.802870 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-project-426013, now list_dbt-project-426013_dbt_dataset)
[0m16:42:28.804124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:29.214838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc180461e90>]}
[0m16:42:29.215904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:29.216378 [info ] [MainThread]: 
[0m16:42:29.221214 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_green_tripdata
[0m16:42:29.221582 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt_dataset.stg_green_tripdata .................... [RUN]
[0m16:42:29.221894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-project-426013_dbt_dataset, now model.taxi_rides_ny.stg_green_tripdata)
[0m16:42:29.222081 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_green_tripdata
[0m16:42:29.238594 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_green_tripdata"
[0m16:42:29.238934 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_green_tripdata
[0m16:42:29.252313 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_green_tripdata"
[0m16:42:29.252674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:29.253450 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_green_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m16:42:29.829817 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:2693f2fd-1da2-42cb-bc3c-68ab0ea16c69&page=queryresults
[0m16:42:30.624673 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17bed8990>]}
[0m16:42:30.625056 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt_dataset.stg_green_tripdata ............... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m16:42:30.625513 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_green_tripdata
[0m16:42:30.625785 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.stg_yellow_tripdata
[0m16:42:30.626164 [info ] [Thread-1 (]: 2 of 17 START sql view model dbt_dataset.stg_yellow_tripdata ................... [RUN]
[0m16:42:30.626581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_green_tripdata, now model.taxi_rides_ny.stg_yellow_tripdata)
[0m16:42:30.626761 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.stg_yellow_tripdata
[0m16:42:30.630761 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m16:42:30.631041 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.stg_yellow_tripdata
[0m16:42:30.633076 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.stg_yellow_tripdata"
[0m16:42:30.633404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:30.634179 [debug] [Thread-1 (]: On model.taxi_rides_ny.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.stg_yellow_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m16:42:31.202415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:2fbb6a74-cb2b-4c89-837c-eecdddaf75c4&page=queryresults
[0m16:42:31.861965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179d8ced0>]}
[0m16:42:31.863030 [info ] [Thread-1 (]: 2 of 17 OK created sql view model dbt_dataset.stg_yellow_tripdata .............. [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m16:42:31.863769 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.stg_yellow_tripdata
[0m16:42:31.864280 [debug] [Thread-1 (]: Began running node seed.taxi_rides_ny.taxi_zone_lookup
[0m16:42:31.864782 [info ] [Thread-1 (]: 3 of 17 START seed file dbt_dataset.taxi_zone_lookup ........................... [RUN]
[0m16:42:31.865578 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.stg_yellow_tripdata, now seed.taxi_rides_ny.taxi_zone_lookup)
[0m16:42:31.865959 [debug] [Thread-1 (]: Began compiling node seed.taxi_rides_ny.taxi_zone_lookup
[0m16:42:31.866219 [debug] [Thread-1 (]: Began executing node seed.taxi_rides_ny.taxi_zone_lookup
[0m16:42:31.878646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:36.603090 [debug] [Thread-1 (]: On seed.taxi_rides_ny.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.taxi_rides_ny.taxi_zone_lookup"} */

    alter table `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup` set OPTIONS()
  
[0m16:42:37.053303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:6bf7977a-7b6f-47f3-b6fd-25311285e3ae&page=queryresults
[0m16:42:37.572173 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.taxi_rides_ny.taxi_zone_lookup"
[0m16:42:37.580455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc17becd450>]}
[0m16:42:37.580740 [info ] [Thread-1 (]: 3 of 17 OK loaded seed file dbt_dataset.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 5.71s]
[0m16:42:37.581022 [debug] [Thread-1 (]: Finished running node seed.taxi_rides_ny.taxi_zone_lookup
[0m16:42:37.581233 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m16:42:37.581530 [info ] [Thread-1 (]: 4 of 17 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m16:42:37.581790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.taxi_rides_ny.taxi_zone_lookup, now test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854)
[0m16:42:37.582119 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m16:42:37.587604 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m16:42:37.588379 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m16:42:37.595510 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m16:42:37.596003 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:37.596706 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m16:42:40.163132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:f98262c3-54f1-4300-b116-34a5c0d399f0&page=queryresults
[0m16:42:43.876343 [info ] [Thread-1 (]: 4 of 17 PASS accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 6.29s]
[0m16:42:43.877360 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m16:42:43.877594 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m16:42:43.877787 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_green_tripdata_tripid .......................... [RUN]
[0m16:42:43.878094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854, now test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b)
[0m16:42:43.878259 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m16:42:43.881576 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m16:42:43.881902 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m16:42:43.882965 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m16:42:43.883218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:43.883966 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m16:42:47.118351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:a5a86928-849a-47de-b436-b52fa4563fed&page=queryresults
[0m16:42:50.978278 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_green_tripdata_tripid ................................ [[32mPASS[0m in 7.10s]
[0m16:42:50.979474 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b
[0m16:42:50.980099 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m16:42:50.980724 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_green_tripdata_tripid ............................ [RUN]
[0m16:42:50.981219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_green_tripdata_tripid.3e149d002b, now test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182)
[0m16:42:50.981728 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m16:42:50.986830 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m16:42:50.987128 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m16:42:50.988236 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m16:42:50.988513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:50.989308 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:42:53.208075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:9cab166d-194e-4f09-ad00-0dade1d6f1d1&page=queryresults
[0m16:42:56.521494 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_green_tripdata_tripid .................................. [[32mPASS[0m in 5.54s]
[0m16:42:56.522627 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182
[0m16:42:56.523210 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m16:42:56.524010 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m16:42:56.524566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_green_tripdata_tripid.d46e7e4182, now test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2)
[0m16:42:56.524899 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m16:42:56.529038 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m16:42:56.529384 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m16:42:56.530728 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m16:42:56.531002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:56.531790 [debug] [Thread-1 (]: On test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m16:42:58.923735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:5f29483c-6d6d-462f-bc39-cba89a7f4d42&page=queryresults
[0m16:43:37.328739 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 40.80s]
[0m16:43:37.329137 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m16:43:37.329356 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m16:43:37.329654 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_yellow_tripdata_tripid ......................... [RUN]
[0m16:43:37.329967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2, now test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c)
[0m16:43:37.330154 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m16:43:37.332838 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m16:43:37.333107 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m16:43:37.334261 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m16:43:37.334514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:37.335233 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m16:43:39.731039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:d2d7b9ba-10f4-4493-a89a-dcbeb56b6e21&page=queryresults
[0m16:44:14.756686 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_yellow_tripdata_tripid ............................... [[32mPASS[0m in 37.43s]
[0m16:44:14.758061 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m16:44:14.758787 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m16:44:14.759481 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_yellow_tripdata_tripid ........................... [RUN]
[0m16:44:14.760047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.not_null_stg_yellow_tripdata_tripid.099802d91c, now test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82)
[0m16:44:14.760447 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m16:44:14.763805 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m16:44:14.764095 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m16:44:14.765288 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m16:44:14.765542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:14.766208 [debug] [Thread-1 (]: On test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m16:44:16.837469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:0fbb1c81-5612-434d-ad59-c8de82acf26f&page=queryresults
[0m16:44:52.089829 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_yellow_tripdata_tripid ................................. [[32mPASS[0m in 37.33s]
[0m16:44:52.090770 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m16:44:52.091390 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dim_zones
[0m16:44:52.092112 [info ] [Thread-1 (]: 10 of 17 START sql table model dbt_dataset.dim_zones ........................... [RUN]
[0m16:44:52.093120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.unique_stg_yellow_tripdata_tripid.7a6ae70c82, now model.taxi_rides_ny.dim_zones)
[0m16:44:52.093574 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dim_zones
[0m16:44:52.097456 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dim_zones"
[0m16:44:52.097909 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dim_zones
[0m16:44:52.112873 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dim_zones"
[0m16:44:52.113182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:52.113851 [debug] [Thread-1 (]: On model.taxi_rides_ny.dim_zones: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.dim_zones"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
    );
  
[0m16:44:52.712487 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:fb90e82d-784c-4c70-baaa-8752f56082a0&page=queryresults
[0m16:44:54.837392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179d50750>]}
[0m16:44:54.838934 [info ] [Thread-1 (]: 10 of 17 OK created sql table model dbt_dataset.dim_zones ...................... [[32mCREATE TABLE (265.0 rows, 14.2 KiB processed)[0m in 2.74s]
[0m16:44:54.840075 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dim_zones
[0m16:44:54.840292 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m16:44:54.840479 [info ] [Thread-1 (]: 11 of 17 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m16:44:54.840832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dim_zones, now test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22)
[0m16:44:54.841032 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m16:44:54.845278 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m16:44:54.845628 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m16:44:54.846731 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m16:44:54.847002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:44:54.847688 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:44:57.124231 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:85c8bb46-00e8-4c03-b126-0c9d639a5bc7&page=queryresults
[0m16:45:01.615180 [info ] [Thread-1 (]: 11 of 17 PASS relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.77s]
[0m16:45:01.616742 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m16:45:01.617715 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m16:45:01.618856 [info ] [Thread-1 (]: 12 of 17 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m16:45:01.619943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22, now test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e)
[0m16:45:01.620123 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m16:45:01.622610 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m16:45:01.622901 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m16:45:01.623944 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m16:45:01.624204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:01.624877 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:45:04.012101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:748bb29b-fb13-4af9-bb0a-5362a60d8278&page=queryresults
[0m16:45:07.909618 [info ] [Thread-1 (]: 12 of 17 PASS relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.29s]
[0m16:45:07.911782 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m16:45:07.912915 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m16:45:07.913183 [info ] [Thread-1 (]: 13 of 17 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m16:45:07.913475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e, now test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f)
[0m16:45:07.913653 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m16:45:07.916017 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m16:45:07.916289 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m16:45:07.917314 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m16:45:07.917567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:07.918430 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:45:10.771445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:3a848dbf-a6d7-421a-809f-b2b618183a67&page=queryresults
[0m16:45:48.626526 [info ] [Thread-1 (]: 13 of 17 PASS relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 40.71s]
[0m16:45:48.628683 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m16:45:48.630036 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m16:45:48.631062 [info ] [Thread-1 (]: 14 of 17 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m16:45:48.631348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f, now test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631)
[0m16:45:48.631538 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m16:45:48.635356 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m16:45:48.635633 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m16:45:48.636710 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m16:45:48.636957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:48.637634 [debug] [Thread-1 (]: On test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:45:50.805695 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:2c69cd73-66b3-4ee8-8d33-8a3dde5ad2f8&page=queryresults
[0m16:46:30.333439 [info ] [Thread-1 (]: 14 of 17 PASS relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 41.70s]
[0m16:46:30.335069 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m16:46:30.337756 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.fact_trips
[0m16:46:30.339063 [info ] [Thread-1 (]: 15 of 17 START sql table model dbt_dataset.fact_trips .......................... [RUN]
[0m16:46:30.339928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.taxi_rides_ny.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631, now model.taxi_rides_ny.fact_trips)
[0m16:46:30.340480 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.fact_trips
[0m16:46:30.342877 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.fact_trips"
[0m16:46:30.347407 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.fact_trips
[0m16:46:30.349349 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.fact_trips"
[0m16:46:30.349880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:30.350600 [debug] [Thread-1 (]: On model.taxi_rides_ny.fact_trips: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.fact_trips"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `dbt-project-426013`.`dbt_dataset`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m16:46:31.022686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:bbbb5c6e-2a2f-4c2c-bce8-c079672ffa1c&page=queryresults
[0m16:47:57.071626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc179caf190>]}
[0m16:47:57.073558 [info ] [Thread-1 (]: 15 of 17 OK created sql table model dbt_dataset.fact_trips ..................... [[32mCREATE TABLE (195.0 rows, 10.0 GiB processed)[0m in 86.73s]
[0m16:47:57.074265 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.fact_trips
[0m16:47:57.075300 [debug] [Thread-1 (]: Began running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m16:47:57.075557 [info ] [Thread-1 (]: 16 of 17 START sql table model dbt_dataset.dm_monthly_zone_revenue ............. [RUN]
[0m16:47:57.075792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.fact_trips, now model.taxi_rides_ny.dm_monthly_zone_revenue)
[0m16:47:57.075963 [debug] [Thread-1 (]: Began compiling node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m16:47:57.082910 [debug] [Thread-1 (]: Writing injected SQL for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m16:47:57.083585 [debug] [Thread-1 (]: Began executing node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m16:47:57.086446 [debug] [Thread-1 (]: Writing runtime sql for node "model.taxi_rides_ny.dm_monthly_zone_revenue"
[0m16:47:57.087020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:57.088312 [debug] [Thread-1 (]: On model.taxi_rides_ny.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.taxi_rides_ny.dm_monthly_zone_revenue"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `dbt-project-426013`.`dbt_dataset`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m16:47:57.676373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:8a86665b-2079-4881-88c4-7aeeef168454&page=queryresults
[0m16:47:59.832900 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e5d91bd-ad7c-4bc5-907b-dc84695c97bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1800a10d0>]}
[0m16:47:59.834252 [info ] [Thread-1 (]: 16 of 17 OK created sql table model dbt_dataset.dm_monthly_zone_revenue ........ [[32mCREATE TABLE (91.0 rows, 40.2 KiB processed)[0m in 2.76s]
[0m16:47:59.835294 [debug] [Thread-1 (]: Finished running node model.taxi_rides_ny.dm_monthly_zone_revenue
[0m16:47:59.836794 [debug] [Thread-1 (]: Began running node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m16:47:59.837318 [info ] [Thread-1 (]: 17 of 17 START test not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m16:47:59.837792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.taxi_rides_ny.dm_monthly_zone_revenue, now test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41)
[0m16:47:59.838172 [debug] [Thread-1 (]: Began compiling node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m16:47:59.841776 [debug] [Thread-1 (]: Writing injected SQL for node "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m16:47:59.842187 [debug] [Thread-1 (]: Began executing node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m16:47:59.844442 [debug] [Thread-1 (]: Writing runtime sql for node "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m16:47:59.849051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:47:59.849720 [debug] [Thread-1 (]: On test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select revenue_monthly_total_amount
from `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
where revenue_monthly_total_amount is null



      
    ) dbt_internal_test
[0m16:48:00.565552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:b0fc8c63-4039-46bb-9a2e-0911b33741df&page=queryresults
[0m16:48:01.462350 [info ] [Thread-1 (]: 17 of 17 PASS not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount .... [[32mPASS[0m in 1.62s]
[0m16:48:01.463791 [debug] [Thread-1 (]: Finished running node test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m16:48:01.465637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:01.465840 [debug] [MainThread]: Connection 'test.taxi_rides_ny.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' was properly closed.
[0m16:48:01.466051 [info ] [MainThread]: 
[0m16:48:01.466236 [info ] [MainThread]: Finished running 2 view models, 1 seed, 11 data tests, 3 table models in 0 hours 5 minutes and 33.03 seconds (333.03s).
[0m16:48:01.468021 [debug] [MainThread]: Command end result
[0m16:48:01.486083 [info ] [MainThread]: 
[0m16:48:01.486360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:48:01.486538 [info ] [MainThread]: 
[0m16:48:01.486756 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m16:48:01.487510 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 333.9727, "process_user_time": 2.755061, "process_kernel_time": 1.447915, "process_mem_max_rss": "238600", "process_in_blocks": "265664", "process_out_blocks": "3344"}
[0m16:48:01.487798 [debug] [MainThread]: Command `dbt build` succeeded at 16:48:01.487749 after 333.97 seconds
[0m16:48:01.487981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ca22bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ca22bb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ca2ab750>]}
[0m16:48:01.488154 [debug] [MainThread]: Flushing usage events
[0m14:38:22.222647 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 14:38:22.227825 | 9149e774-afb1-48fd-badd-a476db1e727a ==============================
[0m14:38:22.227825 [info ] [MainThread]: Running with dbt=1.8.2
[0m14:38:22.228249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:23.007517 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m14:38:23.022238 [debug] [MainThread]: checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109, vars: {}, profile: , target: , version: 1.8.2
[0m14:38:23.105682 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:38:24.180961 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:38:24.417751 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.taxi_rides_ny.staging
- models.taxi_rides_ny.core
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m14:38:24.521741 [info ] [MainThread]: Found 5 models, 1 analysis, 1 seed, 11 data tests, 2 sources, 606 macros
[0m14:38:24.523695 [info ] [MainThread]: 
[0m14:38:24.524143 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:38:24.527154 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-project-426013'
[0m14:38:24.527519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:24.945109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-project-426013, now list_dbt-project-426013_dbt_dataset)
[0m14:38:24.945559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:25.330035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:25.330384 [info ] [MainThread]: 
[0m14:38:25.336469 [debug] [Thread-1 (]: Began running node model.dbt_bq.stg_green_tripdata
[0m14:38:25.336988 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt_dataset.stg_green_tripdata .................... [RUN]
[0m14:38:25.337387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-project-426013_dbt_dataset, now model.dbt_bq.stg_green_tripdata)
[0m14:38:25.337779 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.stg_green_tripdata
[0m14:38:25.347224 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.stg_green_tripdata"
[0m14:38:25.347916 [debug] [Thread-1 (]: Began executing node model.dbt_bq.stg_green_tripdata
[0m14:38:25.368497 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.stg_green_tripdata"
[0m14:38:25.369277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:25.392376 [debug] [Thread-1 (]: On model.dbt_bq.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.stg_green_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m14:38:26.022089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:6e9936b0-278a-4a4e-9446-cba17d489ec1&page=queryresults
[0m14:38:26.590305 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt_dataset.stg_green_tripdata ............... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m14:38:26.590885 [debug] [Thread-1 (]: Finished running node model.dbt_bq.stg_green_tripdata
[0m14:38:26.591222 [debug] [Thread-1 (]: Began running node model.dbt_bq.stg_yellow_tripdata
[0m14:38:26.591645 [info ] [Thread-1 (]: 2 of 17 START sql view model dbt_dataset.stg_yellow_tripdata ................... [RUN]
[0m14:38:26.592091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.stg_green_tripdata, now model.dbt_bq.stg_yellow_tripdata)
[0m14:38:26.592361 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.stg_yellow_tripdata
[0m14:38:26.597976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.stg_yellow_tripdata"
[0m14:38:26.598400 [debug] [Thread-1 (]: Began executing node model.dbt_bq.stg_yellow_tripdata
[0m14:38:26.600330 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.stg_yellow_tripdata"
[0m14:38:26.600701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:26.624164 [debug] [Thread-1 (]: On model.dbt_bq.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.stg_yellow_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m14:38:27.176837 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:9453c574-3634-48b5-b449-499fdbf7bd79&page=queryresults
[0m14:38:27.771841 [info ] [Thread-1 (]: 2 of 17 OK created sql view model dbt_dataset.stg_yellow_tripdata .............. [[32mCREATE VIEW (0 processed)[0m in 1.18s]
[0m14:38:27.772495 [debug] [Thread-1 (]: Finished running node model.dbt_bq.stg_yellow_tripdata
[0m14:38:27.772876 [debug] [Thread-1 (]: Began running node seed.dbt_bq.taxi_zone_lookup
[0m14:38:27.773538 [info ] [Thread-1 (]: 3 of 17 START seed file dbt_dataset.taxi_zone_lookup ........................... [RUN]
[0m14:38:27.773921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.stg_yellow_tripdata, now seed.dbt_bq.taxi_zone_lookup)
[0m14:38:27.774187 [debug] [Thread-1 (]: Began compiling node seed.dbt_bq.taxi_zone_lookup
[0m14:38:27.774426 [debug] [Thread-1 (]: Began executing node seed.dbt_bq.taxi_zone_lookup
[0m14:38:27.793703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:32.874964 [debug] [Thread-1 (]: On seed.dbt_bq.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.dbt_bq.taxi_zone_lookup"} */

    alter table `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup` set OPTIONS()
  
[0m14:38:33.257894 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:f4c61e0d-1a0f-412f-8ef5-4d691102c0bc&page=queryresults
[0m14:38:33.812766 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_bq.taxi_zone_lookup"
[0m14:38:33.815918 [info ] [Thread-1 (]: 3 of 17 OK loaded seed file dbt_dataset.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 6.04s]
[0m14:38:33.816452 [debug] [Thread-1 (]: Finished running node seed.dbt_bq.taxi_zone_lookup
[0m14:38:33.816816 [debug] [Thread-1 (]: Began running node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m14:38:33.817310 [info ] [Thread-1 (]: 4 of 17 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m14:38:33.817945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_bq.taxi_zone_lookup, now test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854)
[0m14:38:33.818224 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m14:38:33.822228 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m14:38:33.822676 [debug] [Thread-1 (]: Began executing node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m14:38:33.833336 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m14:38:33.833873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:33.857221 [debug] [Thread-1 (]: On test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m14:38:36.310120 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:92001196-c608-4eed-b863-07bbfca7bd6b&page=queryresults
[0m14:38:40.948299 [info ] [Thread-1 (]: 4 of 17 PASS accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 7.13s]
[0m14:38:40.948994 [debug] [Thread-1 (]: Finished running node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m14:38:40.949384 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m14:38:40.949761 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_green_tripdata_tripid .......................... [RUN]
[0m14:38:40.950238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854, now test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b)
[0m14:38:40.950570 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m14:38:40.957652 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m14:38:40.958061 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m14:38:40.960024 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m14:38:40.960395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:40.984697 [debug] [Thread-1 (]: On test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m14:38:43.241880 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:1927ef0f-42ee-4123-953b-d88abfd1ae78&page=queryresults
[0m14:38:46.327520 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_green_tripdata_tripid ................................ [[32mPASS[0m in 5.38s]
[0m14:38:46.328048 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m14:38:46.328358 [debug] [Thread-1 (]: Began running node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m14:38:46.328734 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_green_tripdata_tripid ............................ [RUN]
[0m14:38:46.329114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b, now test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182)
[0m14:38:46.329373 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m14:38:46.333951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m14:38:46.334372 [debug] [Thread-1 (]: Began executing node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m14:38:46.339610 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m14:38:46.340102 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:46.364406 [debug] [Thread-1 (]: On test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:38:48.617631 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:c5d35051-d028-4a68-8598-e35f597a73f1&page=queryresults
[0m14:38:51.934391 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_green_tripdata_tripid .................................. [[32mPASS[0m in 5.60s]
[0m14:38:51.935362 [debug] [Thread-1 (]: Finished running node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m14:38:51.935837 [debug] [Thread-1 (]: Began running node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m14:38:51.936324 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m14:38:51.936810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182, now test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2)
[0m14:38:51.937135 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m14:38:51.941531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m14:38:51.941988 [debug] [Thread-1 (]: Began executing node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m14:38:51.943768 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m14:38:51.944204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:51.969209 [debug] [Thread-1 (]: On test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m14:38:54.269672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:f8a0f938-6421-49ea-9db4-25c08bd47351&page=queryresults
[0m14:39:38.396309 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 46.46s]
[0m14:39:38.397916 [debug] [Thread-1 (]: Finished running node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m14:39:38.398571 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m14:39:38.399319 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_yellow_tripdata_tripid ......................... [RUN]
[0m14:39:38.399969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2, now test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c)
[0m14:39:38.400403 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m14:39:38.404481 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m14:39:38.404880 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m14:39:38.406712 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m14:39:38.407090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:38.431487 [debug] [Thread-1 (]: On test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m14:39:40.808279 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:7490c295-933b-4819-8e67-14110a799e22&page=queryresults
[0m14:40:16.463950 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_yellow_tripdata_tripid ............................... [[32mPASS[0m in 38.06s]
[0m14:40:16.464708 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m14:40:16.465046 [debug] [Thread-1 (]: Began running node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m14:40:16.465497 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_yellow_tripdata_tripid ........................... [RUN]
[0m14:40:16.465885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c, now test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82)
[0m14:40:16.466296 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m14:40:16.469917 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m14:40:16.470287 [debug] [Thread-1 (]: Began executing node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m14:40:16.472005 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m14:40:16.472422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:16.496962 [debug] [Thread-1 (]: On test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:18.698625 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:96123837-b9ce-4aa7-bfb0-8bec294b6653&page=queryresults
[0m14:40:57.138733 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_yellow_tripdata_tripid ................................. [[32mPASS[0m in 40.67s]
[0m14:40:57.139586 [debug] [Thread-1 (]: Finished running node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m14:40:57.140060 [debug] [Thread-1 (]: Began running node model.dbt_bq.dim_zones
[0m14:40:57.140597 [info ] [Thread-1 (]: 10 of 17 START sql table model dbt_dataset.dim_zones ........................... [RUN]
[0m14:40:57.141127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82, now model.dbt_bq.dim_zones)
[0m14:40:57.141473 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.dim_zones
[0m14:40:57.144391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.dim_zones"
[0m14:40:57.144904 [debug] [Thread-1 (]: Began executing node model.dbt_bq.dim_zones
[0m14:40:57.162479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:57.589123 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.dim_zones"
[0m14:40:57.589706 [debug] [Thread-1 (]: On model.dbt_bq.dim_zones: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.dim_zones"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
    );
  
[0m14:40:58.124175 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:f2d494c0-c991-42ea-b49d-499849cc3063&page=queryresults
[0m14:41:00.297640 [info ] [Thread-1 (]: 10 of 17 OK created sql table model dbt_dataset.dim_zones ...................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.16s]
[0m14:41:00.298248 [debug] [Thread-1 (]: Finished running node model.dbt_bq.dim_zones
[0m14:41:00.298646 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m14:41:00.299068 [info ] [Thread-1 (]: 11 of 17 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m14:41:00.299433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.dim_zones, now test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22)
[0m14:41:00.299700 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m14:41:00.303439 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m14:41:00.303822 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m14:41:00.305353 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m14:41:00.305714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:00.328618 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:41:02.931585 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:ae5da869-fdf0-4b03-8644-87f728c67d26&page=queryresults
[0m14:41:06.927506 [info ] [Thread-1 (]: 11 of 17 PASS relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.63s]
[0m14:41:06.928757 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m14:41:06.929535 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m14:41:06.930280 [info ] [Thread-1 (]: 12 of 17 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m14:41:06.930942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22, now test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e)
[0m14:41:06.931432 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m14:41:06.937430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m14:41:06.937800 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m14:41:06.939431 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m14:41:06.939835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:06.962705 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:41:09.240071 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:601a482f-503f-4ccb-aa7a-200677067ae2&page=queryresults
[0m14:41:12.908160 [info ] [Thread-1 (]: 12 of 17 PASS relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 5.98s]
[0m14:41:12.909562 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m14:41:12.910403 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m14:41:12.911351 [info ] [Thread-1 (]: 13 of 17 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m14:41:12.912295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e, now test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f)
[0m14:41:12.912932 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m14:41:12.918994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m14:41:12.919505 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m14:41:12.921285 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m14:41:12.921900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:12.945845 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:41:16.171264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:32a603f1-a807-452f-972c-887c075fae1e&page=queryresults
[0m14:41:51.742298 [info ] [Thread-1 (]: 13 of 17 PASS relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 38.83s]
[0m14:41:51.742969 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m14:41:51.743306 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m14:41:51.743657 [info ] [Thread-1 (]: 14 of 17 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m14:41:51.744008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f, now test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631)
[0m14:41:51.744287 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m14:41:51.753692 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m14:41:51.754170 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m14:41:51.756076 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m14:41:51.756594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:51.780655 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:41:55.084219 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:68c2da12-ae30-4ab2-927a-97243f4008de&page=queryresults
[0m14:42:36.405794 [info ] [Thread-1 (]: 14 of 17 PASS relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 44.66s]
[0m14:42:36.406361 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m14:42:36.407335 [debug] [Thread-1 (]: Began running node model.dbt_bq.fact_trips
[0m14:42:36.407787 [info ] [Thread-1 (]: 15 of 17 START sql table model dbt_dataset.fact_trips .......................... [RUN]
[0m14:42:36.408141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631, now model.dbt_bq.fact_trips)
[0m14:42:36.408406 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.fact_trips
[0m14:42:36.411102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.fact_trips"
[0m14:42:36.411492 [debug] [Thread-1 (]: Began executing node model.dbt_bq.fact_trips
[0m14:42:36.413397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:36.798782 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.fact_trips"
[0m14:42:36.799472 [debug] [Thread-1 (]: On model.dbt_bq.fact_trips: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.fact_trips"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `dbt-project-426013`.`dbt_dataset`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m14:42:37.368863 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:8fd7feae-22d5-46b6-80d3-c68d8bcdbf1d&page=queryresults
[0m14:43:54.030266 [info ] [Thread-1 (]: 15 of 17 OK created sql table model dbt_dataset.fact_trips ..................... [[32mCREATE TABLE (198.0 rows, 10.0 GiB processed)[0m in 77.62s]
[0m14:43:54.030870 [debug] [Thread-1 (]: Finished running node model.dbt_bq.fact_trips
[0m14:43:54.031808 [debug] [Thread-1 (]: Began running node model.dbt_bq.dm_monthly_zone_revenue
[0m14:43:54.032219 [info ] [Thread-1 (]: 16 of 17 START sql table model dbt_dataset.dm_monthly_zone_revenue ............. [RUN]
[0m14:43:54.032553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.fact_trips, now model.dbt_bq.dm_monthly_zone_revenue)
[0m14:43:54.032817 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.dm_monthly_zone_revenue
[0m14:43:54.035627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.dm_monthly_zone_revenue"
[0m14:43:54.036003 [debug] [Thread-1 (]: Began executing node model.dbt_bq.dm_monthly_zone_revenue
[0m14:43:54.037731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:54.446721 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.dm_monthly_zone_revenue"
[0m14:43:54.447225 [debug] [Thread-1 (]: On model.dbt_bq.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.dm_monthly_zone_revenue"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `dbt-project-426013`.`dbt_dataset`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m14:43:54.953342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:67d25be7-c308-4c9f-9a10-236f23f639cf&page=queryresults
[0m14:43:57.159051 [info ] [Thread-1 (]: 16 of 17 OK created sql table model dbt_dataset.dm_monthly_zone_revenue ........ [[32mCREATE TABLE (96.0 rows, 40.7 KiB processed)[0m in 3.13s]
[0m14:43:57.160170 [debug] [Thread-1 (]: Finished running node model.dbt_bq.dm_monthly_zone_revenue
[0m14:43:57.161423 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m14:43:57.161929 [info ] [Thread-1 (]: 17 of 17 START test not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m14:43:57.162441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.dm_monthly_zone_revenue, now test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41)
[0m14:43:57.162806 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m14:43:57.166393 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m14:43:57.166881 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m14:43:57.174737 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m14:43:57.175285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:43:57.198673 [debug] [Thread-1 (]: On test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select revenue_monthly_total_amount
from `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
where revenue_monthly_total_amount is null



      
    ) dbt_internal_test
[0m14:43:57.902255 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:263af9d6-ae59-4dd1-9366-940ed9f5f415&page=queryresults
[0m14:43:58.775564 [info ] [Thread-1 (]: 17 of 17 PASS not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount .... [[32mPASS[0m in 1.61s]
[0m14:43:58.776161 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m14:43:58.777430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:58.777690 [debug] [MainThread]: Connection 'test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' was properly closed.
[0m14:43:58.778030 [info ] [MainThread]: 
[0m14:43:58.778314 [info ] [MainThread]: Finished running 2 view models, 1 seed, 11 data tests, 3 table models in 0 hours 5 minutes and 34.25 seconds (334.25s).
[0m14:43:58.779820 [debug] [MainThread]: Command end result
[0m14:43:58.808501 [info ] [MainThread]: 
[0m14:43:58.808887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:58.809177 [info ] [MainThread]: 
[0m14:43:58.809457 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m14:43:58.810460 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 336.63065, "process_user_time": 5.386373, "process_kernel_time": 1.563143, "process_mem_max_rss": "287428", "process_in_blocks": "12952", "process_out_blocks": "12904"}
[0m14:43:58.810974 [debug] [MainThread]: Command `dbt build` succeeded at 14:43:58.810899 after 336.63 seconds
[0m14:43:58.811313 [debug] [MainThread]: Flushing usage events
[0m06:31:03.305332 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 06:31:03.310109 | 3f8ddd89-c666-4ba0-9024-41e6eb338f17 ==============================
[0m06:31:03.310109 [info ] [MainThread]: Running with dbt=1.8.2
[0m06:31:03.310517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --vars {RUN_WITHOT_TEST}', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:31:03.918836 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m06:31:03.933238 [debug] [MainThread]: checksum: 339e8adbee8ea65fd5c2df1f529cee42dfd54478e59835020b782810581b3d5a, vars: {'RUN_WITHOT_TEST': None}, profile: , target: , version: 1.8.2
[0m06:31:04.017970 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:31:04.018341 [debug] [MainThread]: previous checksum: 339e8adbee8ea65fd5c2df1f529cee42dfd54478e59835020b782810581b3d5a, current checksum: f0a141b9de567cb7f131613ba2682f40b3a1c6a157f81c6e5435862eff68f109
[0m06:31:05.072018 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m06:31:05.289582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.taxi_rides_ny.staging
- models.taxi_rides_ny.core
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m06:31:05.384944 [info ] [MainThread]: Found 5 models, 1 analysis, 1 seed, 11 data tests, 2 sources, 606 macros
[0m06:31:05.386871 [info ] [MainThread]: 
[0m06:31:05.387322 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m06:31:05.389852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-project-426013'
[0m06:31:05.390190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:31:05.817670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-project-426013, now list_dbt-project-426013_dbt_dataset)
[0m06:31:05.818243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:06.440274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:31:06.440681 [info ] [MainThread]: 
[0m06:31:06.446471 [debug] [Thread-1 (]: Began running node model.dbt_bq.stg_green_tripdata
[0m06:31:06.446919 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt_dataset.stg_green_tripdata .................... [RUN]
[0m06:31:06.447287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-project-426013_dbt_dataset, now model.dbt_bq.stg_green_tripdata)
[0m06:31:06.447560 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.stg_green_tripdata
[0m06:31:06.456701 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.stg_green_tripdata"
[0m06:31:06.457276 [debug] [Thread-1 (]: Began executing node model.dbt_bq.stg_green_tripdata
[0m06:31:06.477809 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.stg_green_tripdata"
[0m06:31:06.478226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:06.501386 [debug] [Thread-1 (]: On model.dbt_bq.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.stg_green_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'


  limit 100

;


[0m06:31:07.197934 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:cef159b9-3ca3-4a96-877d-c0f0512a238a&page=queryresults
[0m06:31:07.769552 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt_dataset.stg_green_tripdata ............... [[32mCREATE VIEW (0 processed)[0m in 1.32s]
[0m06:31:07.770037 [debug] [Thread-1 (]: Finished running node model.dbt_bq.stg_green_tripdata
[0m06:31:07.770338 [debug] [Thread-1 (]: Began running node model.dbt_bq.stg_yellow_tripdata
[0m06:31:07.770691 [info ] [Thread-1 (]: 2 of 17 START sql view model dbt_dataset.stg_yellow_tripdata ................... [RUN]
[0m06:31:07.771200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.stg_green_tripdata, now model.dbt_bq.stg_yellow_tripdata)
[0m06:31:07.771521 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.stg_yellow_tripdata
[0m06:31:07.783342 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.stg_yellow_tripdata"
[0m06:31:07.783849 [debug] [Thread-1 (]: Began executing node model.dbt_bq.stg_yellow_tripdata
[0m06:31:07.785735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.stg_yellow_tripdata"
[0m06:31:07.786129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:07.809797 [debug] [Thread-1 (]: On model.dbt_bq.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.stg_yellow_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'


  limit 100

;


[0m06:31:08.456867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:168e40f3-ef7c-4ded-86b9-f9d85a8e52b8&page=queryresults
[0m06:31:09.009148 [info ] [Thread-1 (]: 2 of 17 OK created sql view model dbt_dataset.stg_yellow_tripdata .............. [[32mCREATE VIEW (0 processed)[0m in 1.24s]
[0m06:31:09.010173 [debug] [Thread-1 (]: Finished running node model.dbt_bq.stg_yellow_tripdata
[0m06:31:09.010881 [debug] [Thread-1 (]: Began running node seed.dbt_bq.taxi_zone_lookup
[0m06:31:09.011835 [info ] [Thread-1 (]: 3 of 17 START seed file dbt_dataset.taxi_zone_lookup ........................... [RUN]
[0m06:31:09.012638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.stg_yellow_tripdata, now seed.dbt_bq.taxi_zone_lookup)
[0m06:31:09.013239 [debug] [Thread-1 (]: Began compiling node seed.dbt_bq.taxi_zone_lookup
[0m06:31:09.013762 [debug] [Thread-1 (]: Began executing node seed.dbt_bq.taxi_zone_lookup
[0m06:31:09.031490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:14.104183 [debug] [Thread-1 (]: On seed.dbt_bq.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.dbt_bq.taxi_zone_lookup"} */

    alter table `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup` set OPTIONS()
  
[0m06:31:14.490389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:6d558fdd-99e9-4edd-8af1-fcedfa21cce3&page=queryresults
[0m06:31:15.011021 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_bq.taxi_zone_lookup"
[0m06:31:15.013191 [info ] [Thread-1 (]: 3 of 17 OK loaded seed file dbt_dataset.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 6.00s]
[0m06:31:15.013620 [debug] [Thread-1 (]: Finished running node seed.dbt_bq.taxi_zone_lookup
[0m06:31:15.013941 [debug] [Thread-1 (]: Began running node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m06:31:15.014306 [info ] [Thread-1 (]: 4 of 17 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m06:31:15.014763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_bq.taxi_zone_lookup, now test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854)
[0m06:31:15.015015 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m06:31:15.018593 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m06:31:15.019151 [debug] [Thread-1 (]: Began executing node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m06:31:15.030349 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m06:31:15.030835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:15.053980 [debug] [Thread-1 (]: On test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m06:31:17.335489 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:8b607c05-6c16-41cb-95aa-250a0c1b3510&page=queryresults
[0m06:31:21.938982 [info ] [Thread-1 (]: 4 of 17 PASS accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 6.92s]
[0m06:31:21.939742 [debug] [Thread-1 (]: Finished running node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m06:31:21.940148 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m06:31:21.940577 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_green_tripdata_tripid .......................... [RUN]
[0m06:31:21.941023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854, now test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b)
[0m06:31:21.941279 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m06:31:21.947529 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m06:31:21.947943 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m06:31:21.951650 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m06:31:21.952069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:21.975397 [debug] [Thread-1 (]: On test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m06:31:24.225890 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:d597c5a0-4c81-454d-854d-119886b73e79&page=queryresults
[0m06:31:27.355581 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_green_tripdata_tripid ................................ [[32mPASS[0m in 5.41s]
[0m06:31:27.356457 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m06:31:27.356996 [debug] [Thread-1 (]: Began running node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m06:31:27.357604 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_green_tripdata_tripid ............................ [RUN]
[0m06:31:27.358061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b, now test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182)
[0m06:31:27.358397 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m06:31:27.364611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m06:31:27.365102 [debug] [Thread-1 (]: Began executing node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m06:31:27.366684 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m06:31:27.367109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:27.390361 [debug] [Thread-1 (]: On test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:31:29.859682 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:7ca49aae-89ad-4b58-827b-6fc70d2cad5b&page=queryresults
[0m06:31:33.303843 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_green_tripdata_tripid .................................. [[32mPASS[0m in 5.95s]
[0m06:31:33.304362 [debug] [Thread-1 (]: Finished running node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m06:31:33.304668 [debug] [Thread-1 (]: Began running node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m06:31:33.305019 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m06:31:33.305338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182, now test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2)
[0m06:31:33.305593 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m06:31:33.310699 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m06:31:33.311163 [debug] [Thread-1 (]: Began executing node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m06:31:33.312731 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m06:31:33.313117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:33.335921 [debug] [Thread-1 (]: On test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m06:31:35.791399 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:32aa3432-682b-4a58-b659-c5d729328930&page=queryresults
[0m06:32:17.871518 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 44.57s]
[0m06:32:17.872088 [debug] [Thread-1 (]: Finished running node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m06:32:17.872415 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m06:32:17.872698 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_yellow_tripdata_tripid ......................... [RUN]
[0m06:32:17.873193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2, now test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c)
[0m06:32:17.873518 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m06:32:17.876707 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m06:32:17.877135 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m06:32:17.878740 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m06:32:17.879134 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:17.902265 [debug] [Thread-1 (]: On test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m06:32:20.350580 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:69789f64-a23e-4565-83d9-8d8f31359e8c&page=queryresults
[0m06:32:55.966074 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_yellow_tripdata_tripid ............................... [[32mPASS[0m in 38.09s]
[0m06:32:55.966624 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m06:32:55.966958 [debug] [Thread-1 (]: Began running node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m06:32:55.967328 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_yellow_tripdata_tripid ........................... [RUN]
[0m06:32:55.967667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c, now test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82)
[0m06:32:55.967917 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m06:32:55.971010 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m06:32:55.971478 [debug] [Thread-1 (]: Began executing node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m06:32:55.977452 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m06:32:55.977943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:56.001179 [debug] [Thread-1 (]: On test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m06:32:58.333004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:10082e93-182b-4d6e-bd5e-1476c94b2b60&page=queryresults
[0m06:33:56.871815 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_yellow_tripdata_tripid ................................. [[32mPASS[0m in 60.90s]
[0m06:33:56.872360 [debug] [Thread-1 (]: Finished running node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m06:33:56.872675 [debug] [Thread-1 (]: Began running node model.dbt_bq.dim_zones
[0m06:33:56.873154 [info ] [Thread-1 (]: 10 of 17 START sql table model dbt_dataset.dim_zones ........................... [RUN]
[0m06:33:56.873592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82, now model.dbt_bq.dim_zones)
[0m06:33:56.873871 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.dim_zones
[0m06:33:56.876100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.dim_zones"
[0m06:33:56.876496 [debug] [Thread-1 (]: Began executing node model.dbt_bq.dim_zones
[0m06:33:56.884163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:33:57.342602 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.dim_zones"
[0m06:33:57.343171 [debug] [Thread-1 (]: On model.dbt_bq.dim_zones: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.dim_zones"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
    );
  
[0m06:33:57.873719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:cf74c359-861a-40ec-8fb9-b2cb44116195&page=queryresults
[0m06:34:00.087420 [info ] [Thread-1 (]: 10 of 17 OK created sql table model dbt_dataset.dim_zones ...................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.21s]
[0m06:34:00.088608 [debug] [Thread-1 (]: Finished running node model.dbt_bq.dim_zones
[0m06:34:00.089332 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m06:34:00.090111 [info ] [Thread-1 (]: 11 of 17 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m06:34:00.090746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.dim_zones, now test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22)
[0m06:34:00.091166 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m06:34:00.096300 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m06:34:00.096758 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m06:34:00.098518 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m06:34:00.098937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:00.123735 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:34:03.225267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:6624cdad-1935-4c94-9b4a-ffc26bf8be29&page=queryresults
[0m06:34:06.950379 [info ] [Thread-1 (]: 11 of 17 PASS relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.86s]
[0m06:34:06.950989 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m06:34:06.951312 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m06:34:06.951694 [info ] [Thread-1 (]: 12 of 17 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m06:34:06.952238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22, now test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e)
[0m06:34:06.952548 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m06:34:06.958226 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m06:34:06.958831 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m06:34:06.960755 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m06:34:06.961221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:06.984655 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:34:09.579686 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:d9994aac-977f-4c3e-9a0d-3214be5c0e79&page=queryresults
[0m06:34:12.953537 [info ] [Thread-1 (]: 12 of 17 PASS relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.00s]
[0m06:34:12.954642 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m06:34:12.954987 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m06:34:12.955384 [info ] [Thread-1 (]: 13 of 17 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m06:34:12.955876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e, now test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f)
[0m06:34:12.956150 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m06:34:12.962153 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m06:34:12.962609 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m06:34:12.967200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m06:34:12.967655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:12.991898 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:34:15.299259 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:57bc4011-28b4-4211-a0e1-f89b2a39b1c5&page=queryresults
[0m06:34:59.477836 [info ] [Thread-1 (]: 13 of 17 PASS relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 46.52s]
[0m06:34:59.478884 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m06:34:59.479402 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m06:34:59.479844 [info ] [Thread-1 (]: 14 of 17 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m06:34:59.480254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f, now test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631)
[0m06:34:59.480540 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m06:34:59.484720 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m06:34:59.485278 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m06:34:59.487030 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m06:34:59.487421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:59.510609 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m06:35:02.361556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:4e7808de-75d3-4af0-a0b3-c696c41619f5&page=queryresults
[0m06:35:41.954272 [info ] [Thread-1 (]: 14 of 17 PASS relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 42.47s]
[0m06:35:41.955828 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m06:35:41.957254 [debug] [Thread-1 (]: Began running node model.dbt_bq.fact_trips
[0m06:35:41.957990 [info ] [Thread-1 (]: 15 of 17 START sql table model dbt_dataset.fact_trips .......................... [RUN]
[0m06:35:41.958503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631, now model.dbt_bq.fact_trips)
[0m06:35:41.958893 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.fact_trips
[0m06:35:41.963604 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.fact_trips"
[0m06:35:41.964042 [debug] [Thread-1 (]: Began executing node model.dbt_bq.fact_trips
[0m06:35:41.965644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:35:42.394027 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.fact_trips"
[0m06:35:42.395074 [debug] [Thread-1 (]: On model.dbt_bq.fact_trips: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.fact_trips"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `dbt-project-426013`.`dbt_dataset`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m06:35:42.975011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:0ec83aac-cf0f-4b25-a82b-b91cdf497b4e&page=queryresults
[0m06:37:15.820368 [info ] [Thread-1 (]: 15 of 17 OK created sql table model dbt_dataset.fact_trips ..................... [[32mCREATE TABLE (192.0 rows, 10.0 GiB processed)[0m in 93.86s]
[0m06:37:15.820997 [debug] [Thread-1 (]: Finished running node model.dbt_bq.fact_trips
[0m06:37:15.821868 [debug] [Thread-1 (]: Began running node model.dbt_bq.dm_monthly_zone_revenue
[0m06:37:15.822319 [info ] [Thread-1 (]: 16 of 17 START sql table model dbt_dataset.dm_monthly_zone_revenue ............. [RUN]
[0m06:37:15.822673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.fact_trips, now model.dbt_bq.dm_monthly_zone_revenue)
[0m06:37:15.822952 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.dm_monthly_zone_revenue
[0m06:37:15.825642 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.dm_monthly_zone_revenue"
[0m06:37:15.826105 [debug] [Thread-1 (]: Began executing node model.dbt_bq.dm_monthly_zone_revenue
[0m06:37:15.827944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:16.229746 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.dm_monthly_zone_revenue"
[0m06:37:16.230339 [debug] [Thread-1 (]: On model.dbt_bq.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.dm_monthly_zone_revenue"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `dbt-project-426013`.`dbt_dataset`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m06:37:16.769389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:4a6f85f0-694c-484a-8b7a-c28c63ba1210&page=queryresults
[0m06:37:18.987106 [info ] [Thread-1 (]: 16 of 17 OK created sql table model dbt_dataset.dm_monthly_zone_revenue ........ [[32mCREATE TABLE (85.0 rows, 39.5 KiB processed)[0m in 3.16s]
[0m06:37:18.987606 [debug] [Thread-1 (]: Finished running node model.dbt_bq.dm_monthly_zone_revenue
[0m06:37:18.988298 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m06:37:18.988612 [info ] [Thread-1 (]: 17 of 17 START test not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m06:37:18.992984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.dm_monthly_zone_revenue, now test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41)
[0m06:37:18.993377 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m06:37:18.996350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m06:37:18.996771 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m06:37:18.998428 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m06:37:18.998825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:37:19.022016 [debug] [Thread-1 (]: On test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select revenue_monthly_total_amount
from `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
where revenue_monthly_total_amount is null



      
    ) dbt_internal_test
[0m06:37:19.750884 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:f2cd4052-5a4d-44ff-885e-4582d85d3149&page=queryresults
[0m06:37:20.700737 [info ] [Thread-1 (]: 17 of 17 PASS not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount .... [[32mPASS[0m in 1.71s]
[0m06:37:20.701327 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m06:37:20.702547 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:37:20.702826 [debug] [MainThread]: Connection 'test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' was properly closed.
[0m06:37:20.703115 [info ] [MainThread]: 
[0m06:37:20.703381 [info ] [MainThread]: Finished running 2 view models, 1 seed, 11 data tests, 3 table models in 0 hours 6 minutes and 15.32 seconds (375.32s).
[0m06:37:20.704920 [debug] [MainThread]: Command end result
[0m06:37:20.731859 [info ] [MainThread]: 
[0m06:37:20.732259 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:37:20.732516 [info ] [MainThread]: 
[0m06:37:20.732763 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m06:37:20.733419 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 377.47278, "process_user_time": 4.968088, "process_kernel_time": 1.633074, "process_mem_max_rss": "281204", "process_in_blocks": "17072", "process_out_blocks": "4704"}
[0m06:37:20.733821 [debug] [MainThread]: Command `dbt build` succeeded at 06:37:20.733749 after 377.47 seconds
[0m06:37:20.734084 [debug] [MainThread]: Flushing usage events
[0m08:39:11.114468 [debug] [MainThread]: Got an exception trying to initialize tracking


============================== 08:39:11.119275 | b97ddd3a-bf41-4bf8-b757-02b1cf42e1bc ==============================
[0m08:39:11.119275 [info ] [MainThread]: Running with dbt=1.8.2
[0m08:39:11.119737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/airflow/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --vars is_test_run: false', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:39:11.747375 [info ] [MainThread]: Registered adapter: bigquery=1.8.1
[0m08:39:11.761549 [debug] [MainThread]: checksum: 0ec4b80222c0aef1931f7eaf7b0bf3782db7492653439ba11353fb68c7d5f79d, vars: {'is_test_run': False}, profile: , target: , version: 1.8.2
[0m08:39:11.843853 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m08:39:11.844227 [debug] [MainThread]: previous checksum: 0ec4b80222c0aef1931f7eaf7b0bf3782db7492653439ba11353fb68c7d5f79d, current checksum: 339e8adbee8ea65fd5c2df1f529cee42dfd54478e59835020b782810581b3d5a
[0m08:39:12.932864 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m08:39:13.140273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.taxi_rides_ny.core
- models.taxi_rides_ny.staging
- seeds.taxi_rides_ny.taxi_zone_lookup
[0m08:39:13.242531 [info ] [MainThread]: Found 5 models, 1 analysis, 1 seed, 11 data tests, 2 sources, 606 macros
[0m08:39:13.244541 [info ] [MainThread]: 
[0m08:39:13.244962 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m08:39:13.248267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_dbt-project-426013'
[0m08:39:13.248634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:13.664750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt-project-426013, now list_dbt-project-426013_dbt_dataset)
[0m08:39:13.665234 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:39:14.094509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:39:14.094981 [info ] [MainThread]: 
[0m08:39:14.101269 [debug] [Thread-1 (]: Began running node model.dbt_bq.stg_green_tripdata
[0m08:39:14.101694 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt_dataset.stg_green_tripdata .................... [RUN]
[0m08:39:14.102036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt-project-426013_dbt_dataset, now model.dbt_bq.stg_green_tripdata)
[0m08:39:14.102301 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.stg_green_tripdata
[0m08:39:14.111086 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.stg_green_tripdata"
[0m08:39:14.111546 [debug] [Thread-1 (]: Began executing node model.dbt_bq.stg_green_tripdata
[0m08:39:14.131391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.stg_green_tripdata"
[0m08:39:14.131889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:14.155322 [debug] [Thread-1 (]: On model.dbt_bq.stg_green_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.stg_green_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  OPTIONS()
  as 

with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, lpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`green_tripdata`
  where vendorid is not null 
)
select
    -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(lpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,
    
    -- timestamps
    cast(lpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(lpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    safe_cast(trip_type as INT64) as trip_type,

    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(ehail_fee as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1


-- dbt build --select <model_name> --vars '{'is_test_run': 'false'}'
;


[0m08:39:14.821389 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:9617d9af-da01-4391-bc57-e033b1808ab8&page=queryresults
[0m08:39:15.386325 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt_dataset.stg_green_tripdata ............... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m08:39:15.386854 [debug] [Thread-1 (]: Finished running node model.dbt_bq.stg_green_tripdata
[0m08:39:15.387179 [debug] [Thread-1 (]: Began running node model.dbt_bq.stg_yellow_tripdata
[0m08:39:15.387616 [info ] [Thread-1 (]: 2 of 17 START sql view model dbt_dataset.stg_yellow_tripdata ................... [RUN]
[0m08:39:15.388302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.stg_green_tripdata, now model.dbt_bq.stg_yellow_tripdata)
[0m08:39:15.388596 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.stg_yellow_tripdata
[0m08:39:15.394277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.stg_yellow_tripdata"
[0m08:39:15.394721 [debug] [Thread-1 (]: Began executing node model.dbt_bq.stg_yellow_tripdata
[0m08:39:15.402015 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.stg_yellow_tripdata"
[0m08:39:15.402535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:15.426262 [debug] [Thread-1 (]: On model.dbt_bq.stg_yellow_tripdata: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.stg_yellow_tripdata"} */


  create or replace view `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  OPTIONS()
  as 
 
with tripdata as 
(
  select *,
    row_number() over(partition by vendorid, tpep_pickup_datetime) as rn
  from `dbt-project-426013`.`dbt_dataset`.`yellow_tripdata`
  where vendorid is not null 
)
select
   -- identifiers
    to_hex(md5(cast(coalesce(cast(vendorid as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as string), '_dbt_utils_surrogate_key_null_') as string))) as tripid,    
    safe_cast(vendorid as INT64) as vendorid,
    safe_cast(ratecodeid as INT64) as ratecodeid,
    safe_cast(pulocationid as INT64) as pickup_locationid,
    safe_cast(dolocationid as INT64) as dropoff_locationid,

    -- timestamps
    cast(tpep_pickup_datetime as timestamp) as pickup_datetime,
    cast(tpep_dropoff_datetime as timestamp) as dropoff_datetime,
    
    -- trip info
    store_and_fwd_flag,
    safe_cast(passenger_count as INT64) as passenger_count,
    cast(trip_distance as numeric) as trip_distance,
    -- yellow cabs are always street-hail
    1 as trip_type,
    
    -- payment info
    cast(fare_amount as numeric) as fare_amount,
    cast(extra as numeric) as extra,
    cast(mta_tax as numeric) as mta_tax,
    cast(tip_amount as numeric) as tip_amount,
    cast(tolls_amount as numeric) as tolls_amount,
    cast(0 as numeric) as ehail_fee,
    cast(improvement_surcharge as numeric) as improvement_surcharge,
    cast(total_amount as numeric) as total_amount,
    coalesce(safe_cast(payment_type as INT64),0) as payment_type,
    case safe_cast(payment_type as INT64)  
        when 1 then 'Credit card'
        when 2 then 'Cash'
        when 3 then 'No charge'
        when 4 then 'Dispute'
        when 5 then 'Unknown'
        when 6 then 'Voided trip'
        else 'EMPTY'
    end as payment_type_description
from tripdata
where rn = 1

-- dbt build --select <model.sql> --vars '{'is_test_run: false}'
;


[0m08:39:16.047789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:32dfe1c9-4f22-43df-998e-66bf6ffe3452&page=queryresults
[0m08:39:16.586474 [info ] [Thread-1 (]: 2 of 17 OK created sql view model dbt_dataset.stg_yellow_tripdata .............. [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m08:39:16.586993 [debug] [Thread-1 (]: Finished running node model.dbt_bq.stg_yellow_tripdata
[0m08:39:16.587313 [debug] [Thread-1 (]: Began running node seed.dbt_bq.taxi_zone_lookup
[0m08:39:16.587760 [info ] [Thread-1 (]: 3 of 17 START seed file dbt_dataset.taxi_zone_lookup ........................... [RUN]
[0m08:39:16.588222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.stg_yellow_tripdata, now seed.dbt_bq.taxi_zone_lookup)
[0m08:39:16.588492 [debug] [Thread-1 (]: Began compiling node seed.dbt_bq.taxi_zone_lookup
[0m08:39:16.588742 [debug] [Thread-1 (]: Began executing node seed.dbt_bq.taxi_zone_lookup
[0m08:39:16.605208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:21.731564 [debug] [Thread-1 (]: On seed.dbt_bq.taxi_zone_lookup: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "seed.dbt_bq.taxi_zone_lookup"} */

    alter table `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup` set OPTIONS()
  
[0m08:39:22.154860 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:ee6291f7-c4d9-4c65-8b2c-ecb59130bef8&page=queryresults
[0m08:39:22.700373 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_bq.taxi_zone_lookup"
[0m08:39:22.702467 [info ] [Thread-1 (]: 3 of 17 OK loaded seed file dbt_dataset.taxi_zone_lookup ....................... [[32mINSERT 265[0m in 6.11s]
[0m08:39:22.702910 [debug] [Thread-1 (]: Finished running node seed.dbt_bq.taxi_zone_lookup
[0m08:39:22.703223 [debug] [Thread-1 (]: Began running node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m08:39:22.703595 [info ] [Thread-1 (]: 4 of 17 START test accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m08:39:22.704033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_bq.taxi_zone_lookup, now test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854)
[0m08:39:22.704313 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m08:39:22.707702 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m08:39:22.708124 [debug] [Thread-1 (]: Began executing node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m08:39:22.719214 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"
[0m08:39:22.719716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:22.743964 [debug] [Thread-1 (]: On test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m08:39:25.130431 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:09b7731e-859c-401b-af07-43d2ba546af1&page=queryresults
[0m08:39:29.557617 [info ] [Thread-1 (]: 4 of 17 PASS accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 6.85s]
[0m08:39:29.558488 [debug] [Thread-1 (]: Finished running node test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854
[0m08:39:29.559000 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m08:39:29.559605 [info ] [Thread-1 (]: 5 of 17 START test not_null_stg_green_tripdata_tripid .......................... [RUN]
[0m08:39:29.560135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.accepted_values_stg_green_tripdata_Payment_type__False___var_payment_type_values_.f62fdf1854, now test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b)
[0m08:39:29.560463 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m08:39:29.566811 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m08:39:29.567290 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m08:39:29.569006 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"
[0m08:39:29.569548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:29.593809 [debug] [Thread-1 (]: On test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m08:39:31.839264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:32a10f10-11ec-4238-815f-6ee0046c0b0d&page=queryresults
[0m08:39:34.997199 [info ] [Thread-1 (]: 5 of 17 PASS not_null_stg_green_tripdata_tripid ................................ [[32mPASS[0m in 5.44s]
[0m08:39:34.998397 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b
[0m08:39:34.999127 [debug] [Thread-1 (]: Began running node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m08:39:34.999912 [info ] [Thread-1 (]: 6 of 17 START test unique_stg_green_tripdata_tripid ............................ [RUN]
[0m08:39:35.000697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.not_null_stg_green_tripdata_tripid.3e149d002b, now test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182)
[0m08:39:35.001306 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m08:39:35.070822 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m08:39:35.071451 [debug] [Thread-1 (]: Began executing node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m08:39:35.073136 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"
[0m08:39:35.073550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:35.096984 [debug] [Thread-1 (]: On test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:39:37.355854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:c29d5a93-025d-40a3-a673-e32e60e71fab&page=queryresults
[0m08:39:41.999236 [info ] [Thread-1 (]: 6 of 17 PASS unique_stg_green_tripdata_tripid .................................. [[32mPASS[0m in 7.00s]
[0m08:39:42.000169 [debug] [Thread-1 (]: Finished running node test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182
[0m08:39:42.000704 [debug] [Thread-1 (]: Began running node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m08:39:42.001204 [info ] [Thread-1 (]: 7 of 17 START test accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [RUN]
[0m08:39:42.001651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.unique_stg_green_tripdata_tripid.d46e7e4182, now test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2)
[0m08:39:42.001978 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m08:39:42.005580 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m08:39:42.006056 [debug] [Thread-1 (]: Began executing node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m08:39:42.007683 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"
[0m08:39:42.008090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:39:42.031107 [debug] [Thread-1 (]: On test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        Payment_type as value_field,
        count(*) as n_records

    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    group by Payment_type

)

select *
from all_values
where value_field not in (
    1,2,3,4,5,6
)



      
    ) dbt_internal_test
[0m08:39:44.540472 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:e8b619c3-53ad-460b-a090-46a6faf79dc9&page=queryresults
[0m08:40:25.554618 [info ] [Thread-1 (]: 7 of 17 PASS accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_  [[32mPASS[0m in 43.55s]
[0m08:40:25.555125 [debug] [Thread-1 (]: Finished running node test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2
[0m08:40:25.555430 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m08:40:25.555822 [info ] [Thread-1 (]: 8 of 17 START test not_null_stg_yellow_tripdata_tripid ......................... [RUN]
[0m08:40:25.556187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.accepted_values_stg_yellow_tripdata_Payment_type__False___var_payment_type_values_.cf82239ca2, now test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c)
[0m08:40:25.556458 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m08:40:25.559555 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m08:40:25.559967 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m08:40:25.561698 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"
[0m08:40:25.562129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:40:25.585222 [debug] [Thread-1 (]: On test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select tripid
from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
where tripid is null



      
    ) dbt_internal_test
[0m08:40:28.138420 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:cbcddc95-04fd-472e-8e0d-eab12c41ae4f&page=queryresults
[0m08:41:10.533492 [info ] [Thread-1 (]: 8 of 17 PASS not_null_stg_yellow_tripdata_tripid ............................... [[32mPASS[0m in 44.98s]
[0m08:41:10.534006 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c
[0m08:41:10.534304 [debug] [Thread-1 (]: Began running node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m08:41:10.534649 [info ] [Thread-1 (]: 9 of 17 START test unique_stg_yellow_tripdata_tripid ........................... [RUN]
[0m08:41:10.535025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.not_null_stg_yellow_tripdata_tripid.099802d91c, now test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82)
[0m08:41:10.535278 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m08:41:10.539574 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m08:41:10.539992 [debug] [Thread-1 (]: Began executing node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m08:41:10.541467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"
[0m08:41:10.541849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:10.564860 [debug] [Thread-1 (]: On test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select tripid as unique_field
  from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
  where tripid is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m08:41:13.482556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:15a63e30-337d-49ca-be97-8850950af3cb&page=queryresults
[0m08:41:51.654848 [info ] [Thread-1 (]: 9 of 17 PASS unique_stg_yellow_tripdata_tripid ................................. [[32mPASS[0m in 41.12s]
[0m08:41:51.656843 [debug] [Thread-1 (]: Finished running node test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82
[0m08:41:51.657248 [debug] [Thread-1 (]: Began running node model.dbt_bq.dim_zones
[0m08:41:51.657621 [info ] [Thread-1 (]: 10 of 17 START sql table model dbt_dataset.dim_zones ........................... [RUN]
[0m08:41:51.658033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.unique_stg_yellow_tripdata_tripid.7a6ae70c82, now model.dbt_bq.dim_zones)
[0m08:41:51.658318 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.dim_zones
[0m08:41:51.660914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.dim_zones"
[0m08:41:51.661485 [debug] [Thread-1 (]: Began executing node model.dbt_bq.dim_zones
[0m08:41:51.669618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:52.133420 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.dim_zones"
[0m08:41:52.133956 [debug] [Thread-1 (]: On model.dbt_bq.dim_zones: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.dim_zones"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dim_zones`
      
    
    

    OPTIONS()
    as (
      

select 
    locationid, 
    borough, 
    zone, 
    replace(service_zone,'Boro','Green') as service_zone 
from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
    );
  
[0m08:41:52.660370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:44d21c43-a880-4cc8-bc1f-185172ca8bde&page=queryresults
[0m08:41:54.863436 [info ] [Thread-1 (]: 10 of 17 OK created sql table model dbt_dataset.dim_zones ...................... [[32mCREATE TABLE (265.0 rows, 12.1 KiB processed)[0m in 3.20s]
[0m08:41:54.865320 [debug] [Thread-1 (]: Finished running node model.dbt_bq.dim_zones
[0m08:41:54.866571 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m08:41:54.867457 [info ] [Thread-1 (]: 11 of 17 START test relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:41:54.868327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.dim_zones, now test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22)
[0m08:41:54.869143 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m08:41:54.873728 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m08:41:54.874182 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m08:41:54.875767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"
[0m08:41:54.876147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:41:54.898907 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:41:57.446801 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:9e1b1fd1-668d-480d-89c1-4836cc9852c1&page=queryresults
[0m08:42:01.123263 [info ] [Thread-1 (]: 11 of 17 PASS relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.25s]
[0m08:42:01.124546 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22
[0m08:42:01.125250 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m08:42:01.125970 [info ] [Thread-1 (]: 12 of 17 START test relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:42:01.126714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_green_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.d10960da22, now test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e)
[0m08:42:01.127203 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m08:42:01.134491 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m08:42:01.135058 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m08:42:01.137130 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"
[0m08:42:01.137686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:01.160802 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:42:03.819172 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:eb6f1a99-196b-490f-bcde-89b9607ec36e&page=queryresults
[0m08:42:07.776458 [info ] [Thread-1 (]: 12 of 17 PASS relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 6.65s]
[0m08:42:07.777004 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e
[0m08:42:07.777333 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m08:42:07.777704 [info ] [Thread-1 (]: 13 of 17 START test relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:42:07.778046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_green_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.e44ce4891e, now test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f)
[0m08:42:07.778307 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m08:42:07.783478 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m08:42:07.783977 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m08:42:07.785590 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"
[0m08:42:07.785992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:07.809440 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Pickup_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where Pickup_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:42:10.526591 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:47140b30-923a-4f5f-8af6-9a52949404d8&page=queryresults
[0m08:42:49.346660 [info ] [Thread-1 (]: 13 of 17 PASS relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 41.57s]
[0m08:42:49.347220 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f
[0m08:42:49.347545 [debug] [Thread-1 (]: Began running node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m08:42:49.347957 [info ] [Thread-1 (]: 14 of 17 START test relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [RUN]
[0m08:42:49.348323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_yellow_tripdata_Pickup_locationid__locationid__ref_taxi_zone_lookup_.e3a1ac3c4f, now test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631)
[0m08:42:49.348585 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m08:42:49.352354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m08:42:49.352777 [debug] [Thread-1 (]: Began executing node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m08:42:49.354366 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"
[0m08:42:49.354757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:42:49.377692 [debug] [Thread-1 (]: On test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select dropoff_locationid as from_field
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
    where dropoff_locationid is not null
),

parent as (
    select locationid as to_field
    from `dbt-project-426013`.`dbt_dataset`.`taxi_zone_lookup`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m08:42:51.717341 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:3580bbe8-9fd9-45ac-a476-cff7f14c9990&page=queryresults
[0m08:43:30.627050 [info ] [Thread-1 (]: 14 of 17 PASS relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_  [[32mPASS[0m in 41.28s]
[0m08:43:30.627641 [debug] [Thread-1 (]: Finished running node test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631
[0m08:43:30.628585 [debug] [Thread-1 (]: Began running node model.dbt_bq.fact_trips
[0m08:43:30.628948 [info ] [Thread-1 (]: 15 of 17 START sql table model dbt_dataset.fact_trips .......................... [RUN]
[0m08:43:30.629303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_bq.relationships_stg_yellow_tripdata_dropoff_locationid__locationid__ref_taxi_zone_lookup_.c687434631, now model.dbt_bq.fact_trips)
[0m08:43:30.629550 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.fact_trips
[0m08:43:30.632464 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.fact_trips"
[0m08:43:30.632992 [debug] [Thread-1 (]: Began executing node model.dbt_bq.fact_trips
[0m08:43:30.634782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:43:31.072802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.fact_trips"
[0m08:43:31.073479 [debug] [Thread-1 (]: On model.dbt_bq.fact_trips: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.fact_trips"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`fact_trips`
      
    
    

    OPTIONS()
    as (
      

with green_tripdata as (
    select *, 
        'Green' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_green_tripdata`
), 
yellow_tripdata as (
    select *, 
        'Yellow' as service_type
    from `dbt-project-426013`.`dbt_dataset`.`stg_yellow_tripdata`
), 
trips_unioned as (
    select * from green_tripdata
    union all 
    select * from yellow_tripdata
), 
dim_zones as (
    select * from `dbt-project-426013`.`dbt_dataset`.`dim_zones`
    where borough != 'Unknown'
)
select trips_unioned.tripid, 
    trips_unioned.vendorid, 
    trips_unioned.service_type,
    trips_unioned.ratecodeid, 
    trips_unioned.pickup_locationid, 
    pickup_zone.borough as pickup_borough, 
    pickup_zone.zone as pickup_zone, 
    trips_unioned.dropoff_locationid,
    dropoff_zone.borough as dropoff_borough, 
    dropoff_zone.zone as dropoff_zone,  
    trips_unioned.pickup_datetime, 
    trips_unioned.dropoff_datetime, 
    trips_unioned.store_and_fwd_flag, 
    trips_unioned.passenger_count, 
    trips_unioned.trip_distance, 
    trips_unioned.trip_type, 
    trips_unioned.fare_amount, 
    trips_unioned.extra, 
    trips_unioned.mta_tax, 
    trips_unioned.tip_amount, 
    trips_unioned.tolls_amount, 
    trips_unioned.ehail_fee, 
    trips_unioned.improvement_surcharge, 
    trips_unioned.total_amount, 
    trips_unioned.payment_type, 
    trips_unioned.payment_type_description
from trips_unioned
inner join dim_zones as pickup_zone
on trips_unioned.pickup_locationid = pickup_zone.locationid
inner join dim_zones as dropoff_zone
on trips_unioned.dropoff_locationid = dropoff_zone.locationid
    );
  
[0m08:43:31.691515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:27e02f19-dbf6-4ad3-92e4-08e650e48558&page=queryresults
[0m08:44:49.191688 [info ] [Thread-1 (]: 15 of 17 OK created sql table model dbt_dataset.fact_trips ..................... [[32mCREATE TABLE (61.6m rows, 10.0 GiB processed)[0m in 78.56s]
[0m08:44:49.192557 [debug] [Thread-1 (]: Finished running node model.dbt_bq.fact_trips
[0m08:44:49.193482 [debug] [Thread-1 (]: Began running node model.dbt_bq.dm_monthly_zone_revenue
[0m08:44:49.193951 [info ] [Thread-1 (]: 16 of 17 START sql table model dbt_dataset.dm_monthly_zone_revenue ............. [RUN]
[0m08:44:49.194384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.fact_trips, now model.dbt_bq.dm_monthly_zone_revenue)
[0m08:44:49.194664 [debug] [Thread-1 (]: Began compiling node model.dbt_bq.dm_monthly_zone_revenue
[0m08:44:49.197742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_bq.dm_monthly_zone_revenue"
[0m08:44:49.198223 [debug] [Thread-1 (]: Began executing node model.dbt_bq.dm_monthly_zone_revenue
[0m08:44:49.199934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:49.647198 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_bq.dm_monthly_zone_revenue"
[0m08:44:49.647919 [debug] [Thread-1 (]: On model.dbt_bq.dm_monthly_zone_revenue: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "model.dbt_bq.dm_monthly_zone_revenue"} */

  
    

    create or replace table `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
      
    
    

    OPTIONS()
    as (
      

with trips_data as (
    select * from `dbt-project-426013`.`dbt_dataset`.`fact_trips`
)
    select 
    -- Reveneue grouping 
    pickup_zone as revenue_zone,
    timestamp_trunc(
        cast(pickup_datetime as timestamp),
        month
    ) as revenue_month, 

    service_type, 

    -- Revenue calculation 
    sum(fare_amount) as revenue_monthly_fare,
    sum(extra) as revenue_monthly_extra,
    sum(mta_tax) as revenue_monthly_mta_tax,
    sum(tip_amount) as revenue_monthly_tip_amount,
    sum(tolls_amount) as revenue_monthly_tolls_amount,
    sum(ehail_fee) as revenue_monthly_ehail_fee,
    sum(improvement_surcharge) as revenue_monthly_improvement_surcharge,
    sum(total_amount) as revenue_monthly_total_amount,

    -- Additional calculations
    count(tripid) as total_monthly_trips,
    avg(passenger_count) as avg_monthly_passenger_count,
    avg(trip_distance) as avg_monthly_trip_distance

    from trips_data
    group by 1,2,3
    );
  
[0m08:44:50.142577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:e5b8eca9-69bc-433e-afa1-e683028e4797&page=queryresults
[0m08:44:54.544804 [info ] [Thread-1 (]: 16 of 17 OK created sql table model dbt_dataset.dm_monthly_zone_revenue ........ [[32mCREATE TABLE (12.0k rows, 12.5 GiB processed)[0m in 5.35s]
[0m08:44:54.545462 [debug] [Thread-1 (]: Finished running node model.dbt_bq.dm_monthly_zone_revenue
[0m08:44:54.546498 [debug] [Thread-1 (]: Began running node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m08:44:54.547065 [info ] [Thread-1 (]: 17 of 17 START test not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount  [RUN]
[0m08:44:54.547601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_bq.dm_monthly_zone_revenue, now test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41)
[0m08:44:54.547954 [debug] [Thread-1 (]: Began compiling node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m08:44:54.551485 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m08:44:54.551898 [debug] [Thread-1 (]: Began executing node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m08:44:54.559230 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"
[0m08:44:54.559697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:44:54.583673 [debug] [Thread-1 (]: On test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41: /* {"app": "dbt", "dbt_version": "1.8.2", "profile_name": "default", "target_name": "dev", "node_id": "test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select revenue_monthly_total_amount
from `dbt-project-426013`.`dbt_dataset`.`dm_monthly_zone_revenue`
where revenue_monthly_total_amount is null



      
    ) dbt_internal_test
[0m08:44:55.310435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-project-426013&j=bq:US:efee7ef1-1fce-47b9-88c0-ec8bfd7eb85c&page=queryresults
[0m08:44:56.169481 [info ] [Thread-1 (]: 17 of 17 PASS not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount .... [[32mPASS[0m in 1.62s]
[0m08:44:56.170942 [debug] [Thread-1 (]: Finished running node test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41
[0m08:44:56.173931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:56.174673 [debug] [MainThread]: Connection 'test.dbt_bq.not_null_dm_monthly_zone_revenue_revenue_monthly_total_amount.34c3437d41' was properly closed.
[0m08:44:56.175359 [info ] [MainThread]: 
[0m08:44:56.175872 [info ] [MainThread]: Finished running 2 view models, 1 seed, 11 data tests, 3 table models in 0 hours 5 minutes and 42.93 seconds (342.93s).
[0m08:44:56.178056 [debug] [MainThread]: Command end result
[0m08:44:56.206746 [info ] [MainThread]: 
[0m08:44:56.207238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:56.207496 [info ] [MainThread]: 
[0m08:44:56.207738 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 TOTAL=17
[0m08:44:56.208508 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 345.13544, "process_user_time": 5.262381, "process_kernel_time": 1.571616, "process_mem_max_rss": "283960", "process_out_blocks": "4712", "process_in_blocks": "0"}
[0m08:44:56.208949 [debug] [MainThread]: Command `dbt build` succeeded at 08:44:56.208885 after 345.14 seconds
[0m08:44:56.209219 [debug] [MainThread]: Flushing usage events
